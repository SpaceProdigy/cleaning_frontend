import{s as Y,B as C,k as G,u as y,ap as Z,j as e,aq as je,ar as K,a as t,b as V,as as me,at as ee,a1 as ge,i as se,r as u,P as be,T as A,I as te,n as H,au as ye,d as k,M as Ce,av as we,aw as ke,ax as Te}from"./index-DdVm9K2z.js";import{d as Se}from"./Delete-BdMeeVBN.js";import{F as M,a as Re,I as J}from"./OutlinedInput-C4fz-Hk8.js";import{R as ne,F as I,a as O,T as Fe,b as Pe,c as De,d as Q,e as g,f as ve,g as Ie}from"./telegram-BtNSuQ6R.js";import{S as X,M as B}from"./Select-Cx803lCw.js";import{C as ae,P as qe}from"./Pdf-D9JN5m9S.js";import{P as Be}from"./Pagination-1051huzO.js";import{C as Me}from"./CircularProgress-BO8jQ4ir.js";import{d as Oe}from"./Close-1SM-ulnb.js";import"./Stack-BqrEJ1mN.js";const Ae=Y(C)`
  width: 100%;
  margin-top: 10px;
  display: flex;
  justify-content: center;
  gap: 20px;
  align-items: center;
  flex-wrap: wrap;
`;re.propTypes={isLoading:t.bool.isRequired,language:t.string.isRequired,setIsFilterTask:t.func.isRequired,isFilterTas:t.array.isRequired,uniqTaskList:t.object.isRequired,room:t.string.isRequired,setRoom:t.func.isRequired,uniqRoomList:t.array.isRequired,nameCollection:t.string.isRequired};function re({isLoading:p,language:o,setIsFilterTask:i,isFilterTas:f,uniqTaskList:R,room:F,setRoom:x,uniqRoomList:r,nameCollection:l}){var T;const b=G(),j=y(Z);return e.jsxs("div",{children:[e.jsxs(M,{children:[e.jsx(Re,{children:o==="en"?"Show list":"Показувати список"}),e.jsxs(ne,{row:!0,value:j["filter"+l]?j["filter"+l]:"Fully",onChange:h=>b(je({["filter"+l]:h.target.value})),children:[e.jsx(I,{disabled:p,value:"Fully",control:e.jsx(O,{}),label:o==="en"?"Fully":"Повністю"}),e.jsx(I,{disabled:p,value:"Current week",control:e.jsx(O,{}),label:o==="en"?"Current week":"Поточний тиждень"}),e.jsx(I,{disabled:p,value:"Hide past dates",control:e.jsx(O,{}),label:o==="en"?"Hide past dates":"Приховати минулі дати"})]})]}),e.jsxs(Ae,{children:[e.jsxs(M,{size:"small",sx:{width:"150px"},children:[e.jsx(J,{children:o==="en"?"Task":"Завдання"}),e.jsxs(X,{multiple:!0,value:f,label:o==="en"?"Task":"Завдання",onChange:h=>i(h.target.value),children:[e.jsx(B,{value:"",children:o==="en"?"All":"Всі"}),(T=R[o])==null?void 0:T.map((h,S)=>e.jsx(B,{value:R.en[S],children:h},K()))]})]}),e.jsxs(M,{size:"small",sx:{width:"150px"},disabled:p,children:[e.jsx(J,{children:o==="en"?"Room":"Кімната"}),e.jsxs(X,{value:F,label:o==="en"?"Room":"Кімната",onChange:h=>x(h.target.value),children:[e.jsx(B,{value:"",children:o==="en"?"Reset":"Скинути"}),(r==null?void 0:r.length)>0&&(r==null?void 0:r.map(h=>e.jsxs(B,{value:String(h),children:[o==="en"?" Room":" Кімната"," ",h]},K())))]})]})]})]})}oe.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,permissions:t.bool.isRequired,nameCollection:t.string.isRequired,setIsEdit:t.func,handleAddALesson:t.func,setIsChooseALesson:t.func,setValueSelect:t.func,isEdit:t.oneOfType([t.object,t.bool]),isChooseALesson:t.oneOfType([t.object,t.oneOf([null])]),page:t.number.isRequired,setPage:t.func.isRequired,totalPages:t.number.isRequired,setTotalPages:t.func.isRequired};function oe({setIsDeleteModal:p,permissions:o,setIsChooseALesson:i,nameCollection:f,page:R,setPage:F,totalPages:x}){const r=y(V),l=y(me),b=y(ee),j=y(ge)||{},T=y(Z),h=y(se),[S,D]=u.useState([]),[E,v]=u.useState({}),[N,$]=u.useState([]),m=u.useMemo(()=>{const s=new Set,a=new Set;return l==null||l.forEach(({task:n})=>s.add(n.en)),l==null||l.forEach(({task:n})=>a.add(n.ua)),{en:[...s],ua:[...a]}},[l]),q=u.useMemo(()=>{const s=new Set;return l==null||l.map(({roomNumber:n})=>s.add(n)),[...s].sort((n,c)=>n-c)},[l]),ie=G(),[L,ce]=u.useState(""),[_,de]=u.useState(!1),ue=(s,a)=>{F(a)},pe=(s,a,n)=>{n!=null&&n.checker&&n.isDone&&j.uid!==(n==null?void 0:n.checker.userId)||ie(ye({language:r,nameCollection:f,id:a,updateValue:{checked:{isDone:s.target.checked,checker:{displayName:(j==null?void 0:j.roomNumber)??(j==null?void 0:j.displayName)??"",userId:j.uid}}}}))},xe=(s,a,n)=>{const c={td:{textAlign:"center",whiteSpace:"nowrap"}},d=k().format("YYYY-MM-DD"),P=k().isAfter(k(a),"day");return d===a?(c.td.color=n?s.palette.success.dark:s.palette.info.dark,c.backgroundColor=n&&s.palette.success.dark+20,c):(P&&(c.td.color=n?s.palette.success.dark:s.palette.error.dark,c.backgroundColor=n?s.palette.success.dark+20:s.palette.error.dark+20),c)},w=[...l].sort((s,a)=>{const n=new Date(s.date),c=new Date(a.date);if(n-c!==0)return n-c;if(s.task.en.localeCompare(a.task.en)!==0)return s.task.en.localeCompare(a.task.en);const d=parseInt(s.roomNumber,10),P=parseInt(a.roomNumber,10);return d-P}),U=()=>{let s=w;return S.length>0&&(S.includes("")?s=w:s=w==null?void 0:w.filter(a=>S.includes(a.task.en))),L&&(s=s==null?void 0:s.filter(({roomNumber:a})=>String(a)===L)),(T["filter"+f]?T["filter"+f]:"Fully")==="Hide past dates"&&(s=s==null?void 0:s.filter(({date:a})=>k(a).isAfter(k())||k(a).isSame(k(),"day"))),(T["filter"+f]?T["filter"+f]:"Fully")==="Current week"&&(s=s==null?void 0:s.filter(({date:a})=>{const n=k(a),c=k().startOf("week"),d=k().endOf("week");return n.isAfter(c)&&n.isBefore(d)})),s};return u.useEffect(()=>{v(m),$(q)},[q,m]),e.jsxs(e.Fragment,{children:[e.jsx(C,{my:2,children:e.jsx(re,{isLoading:b,language:r,isFilterTas:S,setIsFilterTask:D,uniqTaskList:E,room:L,setRoom:ce,uniqRoomList:N,nameCollection:f})}),e.jsxs(Fe,{elevation:2,sx:{boxShadow:"0px 0px 5px -2px rgba(0,0,0,0.52)"},component:be,children:[e.jsxs(Pe,{children:[e.jsx(De,{children:e.jsxs(Q,{children:[e.jsx(g,{align:"center",sx:{whiteSpace:"nowrap"},children:r==="en"?"Room number":"Номер кімнати"}),e.jsx(g,{align:"center",children:r==="en"?"Date":"Дата"}),e.jsx(g,{align:"center",children:r==="en"?"Task":"Завдання"}),o&&e.jsxs(e.Fragment,{children:[e.jsx(g,{align:"center",children:r==="en"?"Done":"Готово"}),e.jsx(g,{align:"center",sx:{whiteSpace:"nowrap"},children:r==="en"?"Confirmed by":"Підтверджено "}),e.jsx(g,{align:"center",children:r==="en"?"Delete":"Видалити"})]})]})}),e.jsx(ve,{children:w&&w.length>0&&U().map(({_id:s,date:a,roomNumber:n,task:c,checked:d},P,he)=>{var z;const fe=d.isDone;return e.jsxs(Q,{id:s,sx:W=>xe(W,a,fe),children:[e.jsx(g,{children:n}),e.jsx(g,{children:a}),e.jsx(g,{children:c[r]}),o&&e.jsxs(e.Fragment,{children:[e.jsx(g,{align:"center",sx:{display:"flex",alignItems:"center",gap:"10px"},children:e.jsx(ae,{disabled:b,checked:d.isDone,onChange:W=>pe(W,s,d),color:"success"})}),e.jsx(g,{children:(d==null?void 0:d.isDone)&&e.jsx(A,{variant:"caption",whiteSpace:"nowrap",children:(z=d==null?void 0:d.checker)==null?void 0:z.displayName})})]}),o&&e.jsx(e.Fragment,{children:e.jsx(g,{align:"center",children:e.jsx(te,{disabled:b,color:"error",onClick:()=>{p(!0),i(he[P])},children:e.jsx(Se,{})})})})]},P)})})]}),x>1&&e.jsx(C,{width:"100%",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(Be,{count:x,variant:"outlined",color:"primary",disabled:b,page:R,boundaryCount:0,onChange:ue})}),b&&e.jsx(C,{width:"100%",height:"100px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(Me,{})}),!b&&w.length===0&&e.jsx(A,{variant:"h6",textAlign:"center",marginBottom:2,mt:2,children:r==="en"?"Cleaning this month are not yet scheduled":"Прибирання в цьому місяці ще не заплановано"})]}),w&&w.length>0&&e.jsxs(e.Fragment,{children:[_&&e.jsx(qe,{data:U()?U():[],nameCollection:f}),(o||h.includes("pdf"))&&e.jsx(C,{my:2,display:"flex",justifyContent:"center",children:e.jsx(H,{variant:"contained",onClick:()=>de(s=>!s),children:_?r==="en"?"Collapse a PDF":"Згорнути PDF":r==="en"?"Make a PDF":"Зробити PDF"})})]})]})}const Ee=Y(C)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:p})=>p.palette.background.paper};
  box-shadow: ${({theme:p})=>p.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ne=Y(C)`
  position: absolute;
  right: 5px;
  top: 5px;
`;le.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,setIsChooseALesson:t.func,isEdit:t.oneOfType([t.object,t.bool]),isChooseALesson:t.oneOfType([t.object,t.oneOf([null])]),dispatch:t.func,nameCollection:t.string.isRequired};function le({isDeleteModal:p,setIsDeleteModal:o,isChooseALesson:i,setIsChooseALesson:f,dispatch:R,nameCollection:F}){const x=y(V);return e.jsx(Ce,{open:p,onClose:()=>{o(!1)},children:e.jsxs(Ee,{children:[e.jsx(Ne,{children:e.jsx(te,{onClick:()=>{o(!1)},children:e.jsx(Oe,{})})}),e.jsxs(C,{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",children:[i&&e.jsx(A,{variant:"subtitle2",textAlign:"center",sx:r=>({color:r.palette.warning.main}),children:`${i.date} ${x==="en"?"Room:":"Кімната:"} ${i.roomNumber} ${x==="en"?"Task:":"Задача:"} ${i.task[x]}`}),e.jsx(A,{variant:"subtitle2",textAlign:"center",sx:r=>({color:r.palette.error.main}),children:x==="en"?"Warning: If you delete this cleanup, it cannot be restored.":"Попередження: якщо ви видалите це прибирання, його не можна буде відновити."}),e.jsxs(C,{display:"flex",gap:"20px",children:[e.jsx(H,{onClick:()=>o(!1),children:x==="en"?"Close":"Закрити"}),e.jsx(H,{onClick:()=>{R(we({nameCollection:F,id:i._id,language:x})),f(null),o(!1)},children:x==="en"?"Delete":"Видалити"})]})]})]})})}function Ke(){const p=y(V),o=y(ee),[i,f]=u.useState("blueCorridor"),F=y(se).some(m=>m==="superAdmin"),[x,r]=u.useState(null),[l,b]=u.useState(!1),[j,T]=u.useState(1),[h,S]=u.useState(1),[D,E]=u.useState(!1),v=G(),N=m=>{E(m.target.checked)};u.useEffect(()=>{i&&v(ke({nameCollection:i,locationMonth:D?"uncleaned":!1,page:1,limit:200}))},[i,v,D]);const $=m=>{f(m.target.value)};return e.jsxs(C,{height:"100%",mt:2,width:"100%",children:[e.jsxs(C,{children:[e.jsx(M,{disabled:o,children:e.jsx(ne,{row:!0,children:Object.entries(Te).map((m,q)=>e.jsx(I,{value:m[0],control:e.jsx(O,{}),label:m[1][p],onChange:$,checked:i===m[0]},q))})}),e.jsx(Ie,{children:e.jsx(I,{control:e.jsx(ae,{checked:D,onChange:N}),label:"Only uncleaned",disabled:o})})]}),e.jsx(oe,{page:j,setPage:T,totalPages:h,setTotalPages:S,nameCollection:i,permissions:F,isDeleteModal:l,setIsDeleteModal:b,setIsChooseALesson:r}),e.jsx(le,{dispatch:v,isChooseALesson:x,isDeleteModal:l,setIsChooseALesson:r,setIsDeleteModal:b,nameCollection:i})]})}export{Ke as default};
