import{r as T,_ as lt,aN as ct,H as U,j as e,s as M,B as h,u as S,b as H,M as oe,I as Y,T as I,d as n,i as J,aO as dt,a as t,aP as E,l as Pe,N as De,am as ut,P as z,an as pt,ao as xt,a5 as ht,v as mt,w as ft,ap as gt,aa as jt,aQ as ke,p as le,f as ce,as as Ce,at as bt,W as Ie,o as yt,a1 as Tt,c as wt,aK as Te,aA as vt,g as we,A as St,k as Mt,aR as Pt,aS as Dt,a0 as kt,aT as Ct,aU as It}from"./index-DZqmov2c.js";import{r as Rt,s as Re,v as Ft,w as Lt,x as At,y as qt,z as Yt,B as $t,E as Wt,G as Bt,L as Fe,A as Le,k as zt,C as Ht,T as Ae,P as Ot,u as _t,e as Et,D as Nt,a as Vt,R as Ut,F as se,b as ne,c as Gt,d as Jt,f as Qt,g as G,h as F,i as Kt,j as Xt,q as Zt,t as ve,n as es,o as ts,p as ss}from"./Rulse.styled-i3dOSmED.js";import{d as de}from"./Close-BQZOYHYe.js";import{u as ns,C as B}from"./index.esm-CKXPfhAf.js";import{o as rs,c as as,a as re,b as ae}from"./index.esm-vQixu5xJ.js";import{C as ue}from"./CircularProgress-BtArD_Hv.js";import{T as ie,a as is,d as qe,b as Ye}from"./Delete-DyUqR2KT.js";import{F as pe,I as $e,a as os,b as ls}from"./OutlinedInput-CDKzLIDc.js";import{S as We,M as xe,a as cs}from"./Select-DbroyZlY.js";import{A as ds}from"./index-DvVuCRLG.js";import{b as us,c as ps}from"./PostFileUploader-DJricg8n.js";import{c as xs,I as hs,d as ms,a as fs,b as gs}from"./Favorite-D7IwhELG.js";import{U as js}from"./UniversalReactMarkdown-D2b1bHUs.js";import"./createStyled-DYbzq7Ux.js";import"./errorMessages-CYb212sU.js";import"./Link-Bas4CIOx.js";const Be=({adapter:r,value:s,timezone:p,props:a})=>{if(s===null)return null;const{minTime:x,maxTime:o,minutesStep:i,shouldDisableTime:c,disableIgnoringDatePartForTimeValidation:v=!1,disablePast:d,disableFuture:y}=a,l=r.utils.date(void 0,p),w=Rt(v,r.utils);switch(!0){case!r.utils.isValid(s):return"invalidDate";case!!(x&&w(x,s)):return"minTime";case!!(o&&w(s,o)):return"maxTime";case!!(y&&r.utils.isAfter(s,l)):return"disableFuture";case!!(d&&r.utils.isBefore(s,l)):return"disablePast";case!!(c&&c(s,"hours")):return"shouldDisableTime-hours";case!!(c&&c(s,"minutes")):return"shouldDisableTime-minutes";case!!(c&&c(s,"seconds")):return"shouldDisableTime-seconds";case!!(i&&r.utils.getMinutes(s)%i!==0):return"minutesStep";default:return null}};Be.valueManager=Re;const bs=r=>{const s=Ft(r),{forwardedProps:p,internalProps:a}=Lt(s,"time");return At({forwardedProps:p,internalProps:a,valueManager:Re,fieldValueManager:qt,validator:Be,valueType:"time"})},ys=["slots","slotProps","InputProps","inputProps"],Se=T.forwardRef(function(s,p){const a=Yt({props:s,name:"MuiTimeField"}),{slots:x,slotProps:o,InputProps:i,inputProps:c}=a,v=lt(a,ys),d=a,y=(x==null?void 0:x.textField)??(s.enableAccessibleFieldDOMStructure?$t:ie),l=ct({elementType:y,externalSlotProps:o==null?void 0:o.textField,externalForwardedProps:v,ownerState:d,additionalProps:{ref:p}});l.inputProps=U({},c,l.inputProps),l.InputProps=U({},i,l.InputProps);const w=bs(l),C=Wt(w),u=Bt(U({},C,{slots:x,slotProps:o}));return e.jsx(y,U({},u))}),Ts=M(h)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:r})=>r.palette.background.paper};
  box-shadow: ${({theme:r})=>r.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,ws=M(h)`
  position: absolute;
  right: 5px;
  top: 5px;
`;ze.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,deleteItem:t.object.isRequired,dispatch:t.func,nameCollection:t.string.isRequired,setDeleteItem:t.func.isRequired};function ze({isDeleteModal:r,setIsDeleteModal:s,deleteItem:p,dispatch:a,nameCollection:x,setDeleteItem:o}){const i=S(H);return e.jsx(oe,{open:r,onClose:()=>{s(!1)},children:e.jsxs(Ts,{children:[e.jsx(ws,{children:e.jsx(Y,{onClick:()=>{s(!1)},children:e.jsx(de,{})})}),e.jsxs(h,{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",children:[p&&e.jsx(I,{variant:"subtitle2",textAlign:"center",sx:c=>({color:c.palette.warning.main}),children:`${n(p.date).format("DD.MM.YYYY")} ${i==="ua"?"Локація:":"Location:"} ${p.place}, ${i==="ua"?"Час: ":"Time: "}
            ${n(p.startTime).format("HH:mm")}:   ${n(p.endTime).format("HH:mm")}`}),e.jsx(I,{variant:"subtitle2",textAlign:"center",sx:c=>({color:c.palette.error.main}),children:i==="en"?"Warning: If you delete this lesson, it cannot be restored.":"Попередження: якщо ви видалите цей урок, його не можна буде відновити."}),e.jsxs(h,{display:"flex",gap:"20px",children:[e.jsx(J,{onClick:()=>s(!1),children:i==="en"?"Close":"Закрити"}),e.jsx(J,{onClick:()=>{a(dt({nameCollection:x,language:i,id:p._id})).finally(()=>o({})),s(!1)},children:i==="en"?"Delete":"Видалити"})]})]})]})})}const vs=M(h)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:r})=>r.palette.background.paper};
  box-shadow: ${({theme:r})=>r.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ss=M(h)`
  position: absolute;
  right: 5px;
  top: 5px;
`,Ms=r=>as({date:ae().required(r==="ua"?"Дата обов'язкова":"Date is required"),startTime:ae().required(r==="ua"?"Час обов'язковий":"Time is required"),endTime:ae().required(r==="ua"?"Час закінчення обов'язковий":"End time is required").test("is-after",r==="ua"?"Час закінчення повинен бути після початку":"End time must be after start time",function(s){const{startTime:p}=this.parent;return n(s).isAfter(n(p))}),place:re().required(r==="ua"?"Оберіть місце":"Choose a location"),topic:re().max(100,r==="ua"?"Максимум 100 символів":"Max 100 characters"),notes:re().max(500,r==="ua"?"Максимум 500 символів":"Max 500 characters")});He.propTypes={open:t.bool,setOpen:t.func,onSubmit:t.func,isDay:t.object,placeList:t.array.isRequired,editItem:t.object,setEditItem:t.func};function He({open:r,setOpen:s,onSubmit:p,placeList:a,isDay:x,editItem:o,setEditItem:i}){const c=S(H),v=S(E),{control:d,handleSubmit:y,formState:{errors:l},reset:w}=ns({resolver:rs(Ms(c)),defaultValues:{date:x||n(),startTime:n().hour(17).minute(30),endTime:n().hour(19).minute(0),place:a[0].en,topic:"",notes:""},mode:"onChange"}),C=u=>{p(u).finally(()=>w())};return T.useEffect(()=>{(()=>{if(o!=null&&o._id)return w({date:n(o.date).startOf("day"),startTime:n(o.startTime).hour(n(o.startTime).hour()).minute(n(o.startTime).minute()),endTime:n(o.endTime).hour(n(o.endTime).hour()).minute(n(o.endTime).minute()),place:o.place,topic:o.topic,notes:o.notes});if(x)return w({date:x||n(),startTime:n().hour(17).minute(30),endTime:n().hour(19).minute(0),place:a[0].en,topic:"",notes:""})})()},[o,x,a,w,i]),e.jsx(oe,{open:r,onClose:()=>s(!1),children:e.jsxs(vs,{children:[e.jsx(Pe,{open:v,sx:{color:"#fff",zIndex:u=>u.zIndex.modal+1,backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsx(ue,{color:"inherit"})}),e.jsx(Ss,{children:e.jsx(Y,{onClick:()=>s(!1),children:e.jsx(de,{})})}),e.jsxs("form",{onSubmit:y(C),style:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:400},children:[e.jsxs(Fe,{dateAdapter:Le,children:[e.jsx(B,{name:"date",control:d,render:({field:u})=>{var m;return e.jsx(zt,{...u,label:c==="ua"?"Дата":"Date",format:"DD.MM.YYYY",value:u.value||null,onChange:j=>u.onChange(j||n()),slotProps:{textField:{fullWidth:!0,error:!!l.date,helperText:(m=l.date)==null?void 0:m.message,sx:{mb:2}}}})}}),e.jsx(B,{name:"startTime",control:d,render:({field:u})=>{var m;return e.jsx(Se,{...u,label:c==="ua"?"Початок":"Start Time",format:"HH:mm",value:u.value||null,onChange:j=>u.onChange(j||n()),slotProps:{textField:{fullWidth:!0,error:!!l.time,helperText:(m=l.time)==null?void 0:m.message,sx:{mb:2}}}})}}),e.jsx(B,{name:"endTime",control:d,render:({field:u})=>{var m;return e.jsx(Se,{...u,label:c==="ua"?"Час закінчення":"End Time",format:"HH:mm",value:u.value||null,onChange:j=>u.onChange(j||n()),slotProps:{textField:{fullWidth:!0,error:!!l.endTime,helperText:(m=l.endTime)==null?void 0:m.message,sx:{mb:2}}}})}})]}),e.jsx(B,{name:"place",control:d,render:({field:u})=>{var m;return e.jsxs(pe,{sx:{width:"100%",maxWidth:400,mb:2},error:!!l.place,children:[e.jsx($e,{children:c==="ua"?"Виберіть локацію":"Choose a location"}),e.jsx(We,{...u,label:c==="ua"?"Виберіть локацію":"Choose a location",children:a.map((j,f)=>e.jsx(xe,{value:j.en,children:j[c]},f))}),e.jsx(os,{children:(m=l.place)==null?void 0:m.message})]})}}),e.jsx(B,{name:"topic",control:d,render:({field:u})=>{var m;return e.jsx(ie,{...u,label:c==="ua"?"Тема заняття":"Lesson Topic",fullWidth:!0,sx:{mb:2},error:!!l.topic,helperText:((m=l.topic)==null?void 0:m.message)||(c==="ua"?"Максимум 100 символів":"Max 100 characters")})}}),e.jsx(B,{name:"notes",control:d,render:({field:u})=>{var m;return e.jsx(ie,{...u,label:c==="ua"?"Нотатки":"Notes",fullWidth:!0,multiline:!0,rows:3,sx:{mb:2},error:!!l.notes,helperText:((m=l.notes)==null?void 0:m.message)||(c==="ua"?"Максимум 500 символів":"Max 500 characters")})}}),e.jsx(J,{type:"submit",variant:"contained",fullWidth:!0,size:"large",children:c==="en"?"Submit":"Додати"})]})]})})}const Ps=M(h)`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 16px;
`,Ds=M(h)`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;

  padding: 5px 0px;
`;M(h)`
  width: 100%;
  display: flex;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
  color: ${({theme:r})=>r.palette.warning.main};
`;const ks=M(h)`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
`,Cs=M(h)`
  display: flex;
  flex-direction: column;
  /* align-items: center; */
  gap: 5px;
  white-space: nowrap;
`,Is=M(h)`
  display: flex;
  align-items: center;
  gap: 12px;
  white-space: nowrap;
`;M(De)`
  text-decoration: none;
  color: transparent;
`;const Oe=({currentDay:r,handleClose:s,language:p,handleAddALesson:a,isDay:x,setDeleteItem:o,permissions:i,setIsDeleteModal:c,setEditItem:v})=>{const[d]=T.useState(!1),y=S(E);return e.jsx(ut.div,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:100},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(z,{elevation:2,children:e.jsx(Ht,{onClickAway:()=>{d||s()},children:e.jsxs(h,{children:[e.jsxs(Ps,{children:[e.jsx(I,{variant:"subtitle2",children:n(x).format("YYYY-MM-DD")}),e.jsx(Y,{onClick:s,size:"small",children:e.jsx(de,{fontSize:"small"})})]}),i&&e.jsx(e.Fragment,{children:e.jsx(cs,{children:e.jsxs(xe,{disabled:y,onClick:()=>{v({}),a()},children:[e.jsx(pt,{children:p==="en"?"Add Lesson":"Додайти урок"}),e.jsx(xt,{sx:{ml:2},children:e.jsx(is,{color:"success"})})]})})}),r==null?void 0:r.map(({place:l,startTime:w,endTime:C},u,m)=>e.jsxs(Ds,{children:[e.jsx(ht,{sx:{width:"100%"}}),e.jsxs(ks,{children:[e.jsxs(Cs,{children:[e.jsx(I,{variant:"subtitle2",sx:j=>({color:j.palette.success.main}),children:`${l}`}),e.jsx(I,{variant:"subtitle2",sx:j=>({color:j.palette.success.main}),children:`${n(w).format("HH:mm")}:${n(C).format("HH:mm")}`})]}),i&&e.jsxs(Is,{children:[e.jsx(Y,{size:"small",onClick:()=>{v(m[u]),a()},children:e.jsx(qe,{fontSize:"small",color:"secondary"})}),e.jsx(Y,{size:"small",onClick:()=>{o(m[u]),c(!0)},children:e.jsx(Ye,{fontSize:"small",color:"error"})})]})]})]},u))]})})})})};Oe.propTypes={currentDay:t.array,handleAddALesson:t.func,isEdit:t.oneOfType([t.object,t.bool]),setIsEdit:t.func,open:t.bool,handleClose:t.func,language:t.string,isDay:t.oneOfType([t.object,t.oneOf([null])]),setDeleteItem:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,setEditItem:t.func};var he={},Rs=mt;Object.defineProperty(he,"__esModule",{value:!0});var _e=he.default=void 0,Fs=Rs(ft()),Ls=e;_e=he.default=(0,Fs.default)((0,Ls.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");const Ee=({permissions:r,setIsModal:s,setCurrentDay:p,shouldDisplay:a,props:x,language:o})=>{const i=gt(),c=T.useMemo(()=>a.sort((d,y)=>{const l=new Date(d.date),w=new Date(y.date);if(l-w!==0)return l-w;const C=new Date(d.startTime),u=new Date(y.startTime);return C-u}),[a]),v=()=>{!r&&!a||!r&&a.length===0||(s(!0),p(a))};return e.jsx(h,{children:e.jsxs(h,{position:"relative",children:[a.length===1&&e.jsx(h,{sx:{position:"absolute",top:-5,right:-5,zIndex:5},children:e.jsx(_e,{fontSize:"small",sx:{color:i.palette.success.main}})}),e.jsx(h,{children:a.length>1&&e.jsx(h,{sx:d=>({position:"absolute",top:-2,right:-2,width:16,height:16,borderRadius:"50%",background:d.palette.secondary.main,display:"flex",justifyContent:"center",alignItems:"center",zIndex:5}),children:e.jsx(I,{variant:"caption",color:"#111",children:a.length})})}),e.jsx(Ae,{component:"div",classes:{tooltip:"custom-tooltip"},title:c.length>0&&e.jsx("div",{style:{maxHeight:100,overflow:"auto",scrollbarWidth:"thin",padding:5},children:c.map(({startTime:d,endTime:y,place:l})=>e.jsxs("div",{style:{padding:5},children:[e.jsxs(I,{variant:"subtitle2",textAlign:"center",component:"div",children:[o==="ua"?"Локація: ":"Location: ",l]}),e.jsxs(I,{variant:"subtitle2",textAlign:"center",component:"div",children:[o==="ua"?"Час: ":"Time: ",n(d).format("HH:mm"),":",n(y).format("HH:mm")]})]},jt()))}),placement:"top-end",children:e.jsx(Ot,{onClick:v,...x,sx:{border:x.today?`solid 2px ${i.palette.info.main} !important`:a.length>0&&`solid 2px ${i.palette.success.main}`}})})]})})};Ee.propTypes={props:t.object,today:t.bool,setIsModal:t.func,setCurrentDay:t.func,shouldDisplay:t.array,permissions:t.bool.isRequired,isEdit:t.oneOfType([t.object,t.bool]),language:t.string};function Ne({handleAddALesson:r,setIsDay:s,editItem:p,setEditItem:a,open:x,isDay:o,permissions:i,isDeleteModal:c,setIsDeleteModal:v,locationMonth:d,nameCollection:y,currentDay:l,setCurrentDay:w,setDeleteItem:C}){const[u,m]=T.useState(!1),j=S(H),f=S(E),b=S(ke),D=le(),R=()=>{s(null),m(!1)},P=()=>!(n(d).isBefore(n().format("YYYY-MM"))||n(`${d}`).isAfter(n().format("YYYY-MM"))),L=T.useMemo(()=>({day:k})=>b==null?void 0:b.filter(({date:A})=>n(k).isSame(n(A),"day")),[b]),q=T.memo(Ee);return e.jsx(h,{children:e.jsxs(z,{elevation:1,sx:{p:2,position:"relative",boxShadow:"0px 0px 4px -2px rgba(0,0,0,0.52)","& .MuiPickersDay-root.Mui-selected":!P()&&{backgroundColor:"transparent !important",color:"inherit !important"}},children:[e.jsx(Fe,{dateAdapter:Le,localeText:j==="ua"?_t.components.MuiLocalizationProvider.defaultProps.localeText:Et.components.MuiLocalizationProvider.defaultProps.localeText,adapterLocale:j==="ua"?"uk":"en",children:e.jsx(Nt,{disabled:f,value:n(d).isValid()?n(d).date(n().date()):null,onMonthChange:k=>{const A=`/lessons/${y}/${k.format("YYYY-MM")}`;location.pathname!==A&&D(A)},onChange:k=>s(k),views:["day"],loading:f,renderLoading:()=>e.jsx(Vt,{}),slots:{day:k=>{const A=L(k);return e.jsx(q,{permissions:i,setIsModal:m,shouldDisplay:A,props:k,language:j,setCurrentDay:w})}}},j)}),e.jsx(ds,{children:u&&e.jsx(Oe,{setDeleteItem:C,currentDay:l,open:x,editItem:p,setEditItem:a,handleClose:R,language:j,handleAddALesson:r,isDay:o,permissions:i,isDeleteModal:c,setIsDeleteModal:v})})]})})}Ne.propTypes={currentDay:t.array.isRequired,setCurrentDay:t.func.isRequired,handleAddALesson:t.func,setIsDay:t.func,isDay:t.oneOfType([t.object,t.oneOf([null])]),editItem:t.object,setEditItem:t.func,open:t.bool,setValueSelect:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,nameCollection:t.string.isRequired,locationMonth:t.string.isRequired,setDeleteItem:t.func.isRequired};const As=["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],qs=["January","February","March","April","May","June","July","August","September","October","November","December"],Ys=r=>r==="en"?qs:As;Ve.propTypes={nameCollection:t.string.isRequired,locationMonth:t.string.isRequired};function Ve({nameCollection:r,locationMonth:s}){const p=S(H),a=S(E),x=le();return e.jsx(h,{sx:{maxWidth:400,width:"100%",p:"10px"},children:e.jsxs(pe,{fullWidth:!0,disabled:a,children:[e.jsx($e,{children:p==="en"?"Select a month":"Виберіть місяць"}),e.jsx(We,{value:s,label:p==="en"?"Select a month":"Виберіть місяць",onChange:o=>{const i=`/lessons/${r}/${n(o.target.value).format("YYYY-MM")}`;location.pathname!==i&&(console.log("SelectMonth Navigating to:",i),x(i))},children:Ys(p).map((o,i)=>e.jsx(xe,{value:`${new Date().getFullYear()}-${i+1<10?`0${i+1}`:i+1}`,children:o},o))})]})})}Ue.propTypes={isLoading:t.bool.isRequired,language:t.string.isRequired,nameCollection:t.string.isRequired};function Ue({isLoading:r,language:s,nameCollection:p}){const a=ce(),x=S(Ce);return e.jsx("div",{children:e.jsxs(pe,{children:[e.jsx(ls,{children:s==="en"?"Show list":"Показувати список"}),e.jsxs(Ut,{row:!0,value:x["filter"+p]?x["filter"+p]:"Fully",onChange:o=>a(bt({["filter"+p]:o.target.value})),children:[e.jsx(se,{disabled:r,value:"Fully",control:e.jsx(ne,{}),label:s==="en"?"Fully":"Повністю"}),e.jsx(se,{disabled:r,value:"Current week",control:e.jsx(ne,{}),label:s==="en"?"Current week":"Поточний тиждень"}),e.jsx(se,{disabled:r,value:"Hide past dates",control:e.jsx(ne,{}),label:s==="en"?"Hide past dates":"Приховати минулі дати"})]})]})})}Ge.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,permissions:t.bool.isRequired,nameCollection:t.string.isRequired,page:t.number.isRequired,setPage:t.func.isRequired,limit:t.number.isRequired,setLimit:t.func.isRequired,totalPages:t.number.isRequired,setTotalPages:t.func.isRequired,setEditItem:t.func.isRequired,setDeleteItem:t.func.isRequired,handleAddALesson:t.func.isRequired};function Ge({setIsDeleteModal:r,permissions:s,setDeleteItem:p,nameCollection:a,handleAddALesson:x,setEditItem:o,page:i,setPage:c,totalPages:v}){const d=S(H),y=S(ke),l=S(E),w=S(Ce),C=(f,b)=>{c(b)},u=(f,b,D,R)=>{const P={td:{maxWidth:"600px",borderBottom:D||R?"none":null}},L=n().format("YYYY-MM-DD"),q=n().isAfter(n(b),"day");return L===n(b).format("YYYY-MM-DD")?(P.td.color=f.palette.info.dark,P):(q&&(P.td.color=f.palette.grey.A400,P.backgroundColor=f.palette.grey[500]+20),P)},m=[...y].sort((f,b)=>{const D=new Date(f.date),R=new Date(b.date);if(D-R!==0)return D-R;const P=new Date(f.startTime),L=new Date(b.startTime);return P-L}),j=()=>{let f=m;return(w["filter"+a]?w["filter"+a]:"Fully")==="Hide past dates"&&(f=f==null?void 0:f.filter(({date:b})=>n(b).isAfter(n())||n(b).isSame(n(),"day"))),(w["filter"+a]?w["filter"+a]:"Fully")==="Current week"&&(f=f==null?void 0:f.filter(({date:b})=>{const D=n(b),R=n().startOf("week"),P=n().endOf("week");return D.isAfter(R)&&D.isBefore(P)})),f};return e.jsxs(e.Fragment,{children:[e.jsx(Ue,{isLoading:l,language:d,nameCollection:a}),e.jsxs(Gt,{elevation:2,sx:{boxShadow:"0px 0px 5px -2px rgba(0,0,0,0.52)",width:"100%",maxWidth:"800px"},component:z,children:[e.jsxs(Jt,{children:[e.jsx(Qt,{children:e.jsxs(G,{children:[e.jsx(F,{children:d==="ua"?"Дата":"Date"}),e.jsx(F,{children:d==="ua"?"Час":"Time"}),e.jsx(F,{sx:{whiteSpace:"nowrap"},children:d==="ua"?"Локація":"Location"}),s&&e.jsxs(e.Fragment,{children:[e.jsx(F,{align:"center",children:d==="en"?"Edit":"Редагувати"}),e.jsx(F,{align:"center",children:d==="en"?"Delete":"Видалити"})]})]})}),e.jsx(Kt,{children:j().length>0&&j().map(({_id:f,date:b,startTime:D,endTime:R,place:P,topic:L="",notes:q=""},k,A)=>e.jsxs(T.Fragment,{children:[e.jsxs(G,{id:f,sx:W=>u(W,b,L,q),children:[e.jsx(F,{children:n(b).format("DD.MM.YYYY")}),e.jsxs(F,{children:[n(D).format("HH:mm"),":",n(R).format("HH:mm")]}),e.jsx(F,{children:P}),s&&e.jsxs(e.Fragment,{children:[e.jsx(F,{align:"center",children:e.jsx(Y,{disabled:l,color:"secondary",onClick:()=>{o(A[k]),x()},children:e.jsx(qe,{})})}),e.jsx(F,{align:"center",children:e.jsx(Y,{disabled:l,color:"error",onClick:()=>{p(A[k]),r(!0)},children:e.jsx(Ye,{})})})]})]}),L&&e.jsx(G,{sx:W=>({...u(W,b),textAlign:"start",background:"inherit"}),children:e.jsxs(F,{colSpan:5,sx:{overflowWrap:"break-word",borderBottom:q?"none":null},children:["Topic: ",L]})}),q&&e.jsx(G,{sx:W=>({...u(W,b),textAlign:"start",background:"inherit"}),children:e.jsxs(F,{colSpan:5,sx:{overflowWrap:"break-word"},children:["Notes: ",q]})})]},k))})]}),v>1&&e.jsx(h,{width:"100%",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(Xt,{count:v,variant:"outlined",color:"primary",disabled:l,page:i,boundaryCount:0,onChange:C})}),l&&e.jsx(h,{width:"100%",height:"100px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(ue,{})}),!l&&m.length===0&&e.jsx(I,{variant:"h6",textAlign:"center",marginBottom:2,mt:2,children:d==="en"?"Cleaning this month are not yet scheduled":"Прибирання в цьому місяці ще не заплановано"})]})]})}const $s=M(h)`
  margin-bottom: 20px;
  padding: 20px 0;
  width: 100%;
  display: flex;
  flex-wrap: nowrap;
  gap: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  scrollbar-width: thin;
`,Me=M(h)`
  display: flex;
  align-items: center;
  height: 100%;
`,Ws=M(h)`
  display: flex;
  flex-direction: column;

  align-items: center;
  margin-top: 20px;
`,Bs=M(z)`
  flex: 0 0 auto;
  width: 100%;
  max-width: 300px;
  height: 400px;
  overflow: hidden;
  border-radius: 4px;
`,zs=M(h)`
  width: 100%;
  height: 100%;
  max-width: 300px;
  max-height: 180px;
  display: flex;
  align-items: center;
  justify-content: center;
`,Hs=M(h)`
  width: 100%;
  /* height: 100%; */
  max-width: 300px;
  max-height: 50px;
  display: flex;
  overflow: auto;
  scrollbar-width: thin;
`,Os=M(h)`
  padding: 10px;
  width: 100%;
  height: 100%;
  max-height: 220px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;

  overflow: hidden;
`,_s=M(h)`
  width: 100%;
  max-height: 120px;

  overflow: hidden;
`;Je.propTypes={_id:t.string.isRequired,likedBy:t.array.isRequired,likes:t.number.isRequired,setIsLiking:t.func,nameCollection:t.string.isRequired};function Je({_id:r,likedBy:s,likes:p,setIsLiking:a,nameCollection:x}){const o=ce(),i=S(Ie),c=S(yt),v=y=>{a&&a(!0),o(Tt({postId:y,userId:i.uid,displayName:i.displayName,avatar:i.photoURL,nameCollection:x})).finally(()=>{a&&a(!1)})},d=y=>y.length>0?y==null?void 0:y.findIndex(l=>l.userId===(i==null?void 0:i.uid)):-1;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",justifyContent:"flex-end"},children:[e.jsx(Y,{disabled:!c,onClick:()=>v(r),color:d(s)!==-1?"error":"default",children:e.jsx(xs,{sx:{transition:"transform 0.2s",transform:d(s)!==-1?"scale(1.2)":"scale(1)"}})}),e.jsx(I,{variant:"body1",children:p})]})}Qe.propTypes={postsArr:t.array.isRequired,nameCollection:t.string.isRequired};function Qe({postsArr:r,nameCollection:s}){return e.jsx(e.Fragment,{children:r.map(({title:p,_id:a,posters:x,description:o,likes:i,likedBy:c,createdAt:v},d)=>e.jsxs(Bs,{id:d===0?"firstPost":void 0,children:[(x==null?void 0:x.length)>0?e.jsx(hs,{images:x,variant:"post"}):e.jsx(zs,{children:e.jsx(ms,{fontSize:"large"})}),e.jsxs(Os,{children:[e.jsx(Hs,{children:e.jsx(De,{to:`/post/${s}/${a}`,style:{textDecoration:"none"},children:e.jsx(I,{variant:"body2",textAlign:"center",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:p})})}),e.jsx(_s,{children:e.jsxs(I,{variant:"caption",textOverflow:"ellipsis",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[e.jsx(js,{children:o}),o]})}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[v&&e.jsx(I,{variant:"caption",children:n(v).format("DD-MM-YYYY")}),a&&c&&e.jsx(Je,{_id:a,likedBy:c,likes:i,nameCollection:s})]})]})]},a))})}const Es=({permissions:r,nameCollection:s,image:p,placeList:a,mainTitle:x,defaultCategory:o=null})=>{const i=S(H),[c,v]=T.useState(!1),{displayName:d="No name",uid:y="No ID"}=S(Ie)||{},l=S(wt(s)),w=Te("(min-width:1100px)"),C=Te("(min-width:600px)"),u=le(),m=vt(),j=ce(),f=m.pathname.split("/")[3],[b,D]=T.useState({}),[R,P]=T.useState({}),[L,q]=T.useState([]),[k,A]=T.useState(n()),[W,N]=T.useState(!1),[Q,K]=T.useState(!1),[X,Ke]=T.useState(1),[Z,Xe]=T.useState(100),[Ze,me]=T.useState(1),[$,fe]=T.useState(1),[ge]=T.useState(10),[ee,et]=T.useState(1),[tt,te]=T.useState(!1),st=T.useRef(null),nt=()=>te(!0),rt=()=>te(!1),je=()=>N(!0),be=()=>{if(l.length>0){const g=document.getElementById("firstPost");g&&window.requestAnimationFrame(()=>{g.scrollIntoView({behavior:"smooth",block:"start"})})}},at=()=>{$<ee&&(fe($+1),be())},it=()=>{$>1&&(fe($-1),be())},ot=async g=>{if(!(g!=null&&g.date)||!(g!=null&&g.startTime)||!(g!=null&&g.endTime))return;const O=n(g.date).startOf("day").toISOString(),_=n(g.date).hour(n(g.startTime).hour()).minute(n(g.startTime).minute()).toISOString(),V=n(g.date).hour(n(g.endTime).hour()).minute(n(g.endTime).minute()).toISOString();if(n(_).isAfter(n(V))){kt("error",i==="ua"?"Час закінчення не може бути раніше початку!":"End time cannot be earlier than start time!");return}const ye={date:O,startTime:_,endTime:V,place:g.place,topic:g.topic,notes:g.notes,adder:{displayName:d,uid:y}};if(b._id){j(Ct({id:b._id,language:i,nameCollection:s,updateValue:ye})).finally(()=>{N(!1),D({})});return}else j(It({language:i,nameCollection:s,data:ye})).finally(()=>N(!1))};return T.useEffect(()=>{const g=we.CancelToken.source(),O=`/lessons/${s}/${f}`;return m.pathname!==O&&u(O),(async()=>{try{await j(Pt({nameCollection:s,locationMonth:f,cancelToken:g,setTotalPages:me,page:X,limit:Z}))}catch(V){console.error("Ошибка при загрузке расписания:",V)}})(),()=>g.cancel("Компонент размонтирован или маршрут изменен")},[j,Z,m.pathname,f,s,u,X]),T.useEffect(()=>{const g=we.CancelToken.source();return(async()=>{try{await j(Dt({nameCollection:s,tag:s,page:$,limit:ge,cancelToken:g,setTotalPages:et}))}catch(_){console.error("Ошибка при загрузке постов:",_)}})(),()=>g.cancel("Компонент размонтирован или параметры постов изменены")},[j,s,$,ge]),e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsxs(h,{sx:{mb:5,width:"100%"},children:[e.jsx(Zt,{image:p,title:x}),e.jsxs(h,{display:"flex",width:"100%",gap:"40px",mt:"40px",flexWrap:w?"nowrap":"wrap",justifyContent:"center",children:[e.jsx(Ne,{nameCollection:s,locationMonth:f,handleAddALesson:je,setIsDay:A,setEditItem:D,editItem:b,open:W,isDay:k,currentDay:L,setCurrentDay:q,permissions:r,isDeleteModal:Q,setIsDeleteModal:K,setDeleteItem:P}),e.jsx(z,{elevation:C?1:0,sx:{padding:C?5:"30px 0 0 0",width:"100%",boxShadow:"0px 0px 3px -2px rgba(0,0,0,0.82)"},children:e.jsxs(h,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:"30px",children:[e.jsx(z,{elevation:2,sx:{width:"100%",maxWidth:"400px",boxShadow:"0px 0px 3px -2px rgba(0,0,0,0.82)"},children:e.jsx(Ve,{nameCollection:s,locationMonth:f})}),e.jsx(Ge,{nameCollection:s,page:X,setPage:Ke,limit:Z,setLimit:Xe,totalPages:Ze,setTotalPages:me,permissions:r,isDeleteModal:Q,setIsDeleteModal:K,handleAddALesson:je,setEditItem:D,setDeleteItem:P}),ve[s]&&e.jsx(Ae,{title:i==="en"?"Open a group in Telegram":"Відкрити групу в Telegram",children:e.jsx(es,{href:ve[s]??null,target:"_blank",rel:"noopener noreferrer",children:e.jsxs(ts,{component:"div",variant:"button",children:[i==="en"?"JOIN":"ПРИЕДНАТИСЯ",e.jsx(ss,{color:"info",fontSize:"large"})]})})})]})})]}),e.jsxs(Ws,{children:[e.jsx($s,{ref:st,children:(l==null?void 0:l.length)>0&&e.jsxs(e.Fragment,{children:[ee>1&&$>1&&e.jsx(Me,{children:e.jsx(Y,{size:"large",onClick:it,disabled:$===1,children:e.jsx(fs,{fontSize:"large"})})}),e.jsx(Qe,{postsArr:l,nameCollection:s}),ee!==$&&e.jsx(Me,{children:e.jsx(Y,{size:"large",onClick:at,children:e.jsx(gs,{fontSize:"large"})})})]})}),r&&e.jsx(J,{variant:"contained",onClick:nt,children:Mt.addPost[i]})]}),e.jsx(Pe,{open:c,sx:{color:"#fff",zIndex:g=>g.zIndex.drawer+1},children:e.jsx(ue,{color:"inherit"})}),e.jsx(oe,{open:tt,onClose:rt,closeAfterTransition:!0,children:e.jsx(us,{children:e.jsx(ps,{nameCollection:s,setOpen:te,setLoading:v,defaultTag:s,defaultCategory:o})})}),e.jsx(He,{open:W,setOpen:N,onSubmit:ot,placeList:a,isDay:k,editItem:b,setEditItem:D}),e.jsx(ze,{dispatch:j,isDeleteModal:Q,setIsDeleteModal:K,nameCollection:s,deleteItem:R,setDeleteItem:P})]})]})};Es.propTypes={permissions:t.bool.isRequired,nameCollection:t.string.isRequired,image:t.string.isRequired,placeList:t.array.isRequired,mainTitle:t.string.isRequired,defaultCategory:t.string};export{Es as default};
