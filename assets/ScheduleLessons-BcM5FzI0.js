import{r as w,_ as dt,aY as ut,H as N,j as e,s as P,B as h,u as S,b as O,M as le,I as Y,T as L,d as n,i as G,aZ as pt,a as t,a_ as _,l as ke,N as Ce,aa as xt,P as z,az as ht,aA as mt,a5 as ft,v as gt,w as jt,aB as bt,an as yt,a$ as Fe,p as ce,f as de,aE as Ie,aF as Tt,W as Le,o as wt,a1 as vt,Y as St,c as Pt,aV as ve,aL as Mt,g as Se,A as Dt,k as kt,b0 as Ct,b1 as Ft,a0 as It,b2 as Lt,b3 as Rt}from"./index-VRjfB3Or.js";import{q as At,s as Re,r as qt,v as Yt,w as $t,x as Wt,y as Bt,z as zt,B as Ht,E as Ot,L as Ae,A as qe,j as _t,C as Et,T as Ye,P as Vt,u as Nt,e as Ut,D as Gt,a as Jt,R as Qt,F as se,b as ne,c as Zt,d as Kt,f as Xt,g as U,h as A,i as es,p as ts,t as Pe,m as ss,n as ns,o as rs,G as re}from"./Rulse.styled-D8fB8H9E.js";import{d as ue}from"./Close-C2mmMyaN.js";import{u as as,C as H}from"./index.esm-C2hpFCo6.js";import{o as is,c as os,a as ae,b as ie}from"./index.esm-Dops2Hi3.js";import{C as pe}from"./CircularProgress-D0AM8zLf.js";import{T as oe,d as $e}from"./Delete-DVwDU4aW.js";import{F as xe,I as We,a as ls,b as cs}from"./OutlinedInput-Ilw7ROUx.js";import{S as Be,M as he,a as ds}from"./Select-xWJOb_Sv.js";import{a as us,d as ze}from"./Edit-CXhxEM_5.js";import{A as ps}from"./index-C1D0ZcF1.js";import{P as xs}from"./Pagination-kz10Bpbt.js";import{b as hs,c as ms}from"./PostFileUploader-CK23R5ge.js";import{b as fs,d as gs,a as js}from"./Favorite-CtyaiL_a.js";import{I as bs,d as ys}from"./ImageNotSupported-vrt7yV1Q.js";import{U as Ts}from"./UniversalReactMarkdown-CM6r6ag9.js";import"./createStyled-ZigSP4Rc.js";import"./index-DuAv5noY.js";import"./Link-CqX-KLFY.js";import"./CloudUpload-DNXG-YZ9.js";import"./errorMessages-CzWlP_QR.js";const He=({adapter:r,value:s,timezone:p,props:a})=>{if(s===null)return null;const{minTime:x,maxTime:o,minutesStep:i,shouldDisableTime:l,disableIgnoringDatePartForTimeValidation:v=!1,disablePast:d,disableFuture:y}=a,c=r.utils.date(void 0,p),b=At(v,r.utils);switch(!0){case!r.utils.isValid(s):return"invalidDate";case!!(x&&b(x,s)):return"minTime";case!!(o&&b(s,o)):return"maxTime";case!!(y&&r.utils.isAfter(s,c)):return"disableFuture";case!!(d&&r.utils.isBefore(s,c)):return"disablePast";case!!(l&&l(s,"hours")):return"shouldDisableTime-hours";case!!(l&&l(s,"minutes")):return"shouldDisableTime-minutes";case!!(l&&l(s,"seconds")):return"shouldDisableTime-seconds";case!!(i&&r.utils.getMinutes(s)%i!==0):return"minutesStep";default:return null}};He.valueManager=Re;const ws=r=>{const s=qt(r),{forwardedProps:p,internalProps:a}=Yt(s,"time");return $t({forwardedProps:p,internalProps:a,valueManager:Re,fieldValueManager:Wt,validator:He,valueType:"time"})},vs=["slots","slotProps","InputProps","inputProps"],Me=w.forwardRef(function(s,p){const a=Bt({props:s,name:"MuiTimeField"}),{slots:x,slotProps:o,InputProps:i,inputProps:l}=a,v=dt(a,vs),d=a,y=(x==null?void 0:x.textField)??(s.enableAccessibleFieldDOMStructure?zt:oe),c=ut({elementType:y,externalSlotProps:o==null?void 0:o.textField,externalForwardedProps:v,ownerState:d,additionalProps:{ref:p}});c.inputProps=N({},l,c.inputProps),c.InputProps=N({},i,c.InputProps);const b=ws(c),F=Ht(b),u=Ot(N({},F,{slots:x,slotProps:o}));return e.jsx(y,N({},u))}),Ss=P(h)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:r})=>r.palette.background.paper};
  box-shadow: ${({theme:r})=>r.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ps=P(h)`
  position: absolute;
  right: 5px;
  top: 5px;
`;Oe.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,deleteItem:t.object.isRequired,dispatch:t.func,nameCollection:t.string.isRequired,setDeleteItem:t.func.isRequired};function Oe({isDeleteModal:r,setIsDeleteModal:s,deleteItem:p,dispatch:a,nameCollection:x,setDeleteItem:o}){const i=S(O);return e.jsx(le,{open:r,onClose:()=>{s(!1)},children:e.jsxs(Ss,{children:[e.jsx(Ps,{children:e.jsx(Y,{onClick:()=>{s(!1)},children:e.jsx(ue,{})})}),e.jsxs(h,{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",children:[p&&e.jsx(L,{variant:"subtitle2",textAlign:"center",sx:l=>({color:l.palette.warning.main}),children:`${n(p.date).format("DD.MM.YYYY")} ${i==="ua"?"Локація:":"Location:"} ${p.place}, ${i==="ua"?"Час: ":"Time: "}
            ${n(p.startTime).format("HH:mm")}:   ${n(p.endTime).format("HH:mm")}`}),e.jsx(L,{variant:"subtitle2",textAlign:"center",sx:l=>({color:l.palette.error.main}),children:i==="en"?"Warning: If you delete this lesson, it cannot be restored.":"Попередження: якщо ви видалите цей урок, його не можна буде відновити."}),e.jsxs(h,{display:"flex",gap:"20px",children:[e.jsx(G,{onClick:()=>s(!1),children:i==="en"?"Close":"Закрити"}),e.jsx(G,{onClick:()=>{a(pt({nameCollection:x,language:i,id:p._id})).finally(()=>o({})),s(!1)},children:i==="en"?"Delete":"Видалити"})]})]})]})})}const Ms=P(h)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:r})=>r.palette.background.paper};
  box-shadow: ${({theme:r})=>r.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ds=P(h)`
  position: absolute;
  right: 5px;
  top: 5px;
`,ks=r=>os({date:ie().required(r==="ua"?"Дата обов'язкова":"Date is required"),startTime:ie().required(r==="ua"?"Час обов'язковий":"Time is required"),endTime:ie().required(r==="ua"?"Час закінчення обов'язковий":"End time is required").test("is-after",r==="ua"?"Час закінчення повинен бути після початку":"End time must be after start time",function(s){const{startTime:p}=this.parent;return n(s).isAfter(n(p))}),place:ae().required(r==="ua"?"Оберіть місце":"Choose a location"),topic:ae().max(100,r==="ua"?"Максимум 100 символів":"Max 100 characters"),notes:ae().max(500,r==="ua"?"Максимум 500 символів":"Max 500 characters")});_e.propTypes={open:t.bool,setOpen:t.func,onSubmit:t.func,isDay:t.object,placeList:t.array.isRequired,editItem:t.object,setEditItem:t.func};function _e({open:r,setOpen:s,onSubmit:p,placeList:a,isDay:x,editItem:o,setEditItem:i}){const l=S(O),v=S(_),{control:d,handleSubmit:y,formState:{errors:c},reset:b}=as({resolver:is(ks(l)),defaultValues:{date:x||n(),startTime:n().hour(17).minute(30),endTime:n().hour(19).minute(0),place:a[0].en,topic:"",notes:""},mode:"onChange"}),F=u=>{p(u).finally(()=>b())};return w.useEffect(()=>{(()=>{if(o!=null&&o._id)return b({date:n(o.date).startOf("day"),startTime:n(o.startTime).hour(n(o.startTime).hour()).minute(n(o.startTime).minute()),endTime:n(o.endTime).hour(n(o.endTime).hour()).minute(n(o.endTime).minute()),place:o.place,topic:o.topic,notes:o.notes});if(x)return b({date:x||n(),startTime:n().hour(17).minute(30),endTime:n().hour(19).minute(0),place:a[0].en,topic:"",notes:""})})()},[o,x,a,b,i]),e.jsx(le,{open:r,onClose:()=>s(!1),children:e.jsxs(Ms,{children:[e.jsx(ke,{open:v,sx:{color:"#fff",zIndex:u=>u.zIndex.modal+1,backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsx(pe,{color:"inherit"})}),e.jsx(Ds,{children:e.jsx(Y,{onClick:()=>s(!1),children:e.jsx(ue,{})})}),e.jsxs("form",{onSubmit:y(F),style:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:400},children:[e.jsxs(Ae,{dateAdapter:qe,children:[e.jsx(H,{name:"date",control:d,render:({field:u})=>{var g;return e.jsx(_t,{...u,label:l==="ua"?"Дата":"Date",format:"DD.MM.YYYY",value:u.value||null,onChange:T=>u.onChange(T||n()),slotProps:{textField:{fullWidth:!0,error:!!c.date,helperText:(g=c.date)==null?void 0:g.message,sx:{mb:2}}}})}}),e.jsx(H,{name:"startTime",control:d,render:({field:u})=>{var g;return e.jsx(Me,{...u,label:l==="ua"?"Початок":"Start Time",format:"HH:mm",value:u.value||null,onChange:T=>u.onChange(T||n()),slotProps:{textField:{fullWidth:!0,error:!!c.time,helperText:(g=c.time)==null?void 0:g.message,sx:{mb:2}}}})}}),e.jsx(H,{name:"endTime",control:d,render:({field:u})=>{var g;return e.jsx(Me,{...u,label:l==="ua"?"Час закінчення":"End Time",format:"HH:mm",value:u.value||null,onChange:T=>u.onChange(T||n()),slotProps:{textField:{fullWidth:!0,error:!!c.endTime,helperText:(g=c.endTime)==null?void 0:g.message,sx:{mb:2}}}})}})]}),e.jsx(H,{name:"place",control:d,render:({field:u})=>{var g;return e.jsxs(xe,{sx:{width:"100%",maxWidth:400,mb:2},error:!!c.place,children:[e.jsx(We,{children:l==="ua"?"Виберіть локацію":"Choose a location"}),e.jsx(Be,{...u,label:l==="ua"?"Виберіть локацію":"Choose a location",children:a.map((T,m)=>e.jsx(he,{value:T.en,children:T[l]},m))}),e.jsx(ls,{children:(g=c.place)==null?void 0:g.message})]})}}),e.jsx(H,{name:"topic",control:d,render:({field:u})=>{var g;return e.jsx(oe,{...u,label:l==="ua"?"Тема заняття":"Lesson Topic",fullWidth:!0,sx:{mb:2},error:!!c.topic,helperText:((g=c.topic)==null?void 0:g.message)||(l==="ua"?"Максимум 100 символів":"Max 100 characters")})}}),e.jsx(H,{name:"notes",control:d,render:({field:u})=>{var g;return e.jsx(oe,{...u,label:l==="ua"?"Нотатки":"Notes",fullWidth:!0,multiline:!0,rows:3,sx:{mb:2},error:!!c.notes,helperText:((g=c.notes)==null?void 0:g.message)||(l==="ua"?"Максимум 500 символів":"Max 500 characters")})}}),e.jsx(G,{type:"submit",variant:"contained",fullWidth:!0,size:"large",children:l==="en"?"Submit":"Додати"})]})]})})}const Cs=P(h)`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 16px;
`,Fs=P(h)`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;

  padding: 5px 0px;
`;P(h)`
  width: 100%;
  display: flex;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
  color: ${({theme:r})=>r.palette.warning.main};
`;const Is=P(h)`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
`,Ls=P(h)`
  display: flex;
  flex-direction: column;
  /* align-items: center; */
  gap: 5px;
  white-space: nowrap;
`,Rs=P(h)`
  display: flex;
  align-items: center;
  gap: 12px;
  white-space: nowrap;
`;P(Ce)`
  text-decoration: none;
  color: transparent;
`;const Ee=({currentDay:r,handleClose:s,language:p,handleAddALesson:a,isDay:x,setDeleteItem:o,permissions:i,setIsDeleteModal:l,setEditItem:v})=>{const[d]=w.useState(!1),y=S(_);return e.jsx(xt.div,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:100},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(z,{elevation:2,children:e.jsx(Et,{onClickAway:()=>{d||s()},children:e.jsxs(h,{children:[e.jsxs(Cs,{children:[e.jsx(L,{variant:"subtitle2",children:n(x).format("YYYY-MM-DD")}),e.jsx(Y,{onClick:s,size:"small",children:e.jsx(ue,{fontSize:"small"})})]}),i&&e.jsx(e.Fragment,{children:e.jsx(ds,{children:e.jsxs(he,{disabled:y,onClick:()=>{v({}),a()},children:[e.jsx(ht,{children:p==="en"?"Add Lesson":"Додайти урок"}),e.jsx(mt,{sx:{ml:2},children:e.jsx(us,{color:"success"})})]})})}),r==null?void 0:r.map(({place:c,startTime:b,endTime:F},u,g)=>e.jsxs(Fs,{children:[e.jsx(ft,{sx:{width:"100%"}}),e.jsxs(Is,{children:[e.jsxs(Ls,{children:[e.jsx(L,{variant:"subtitle2",sx:T=>({color:T.palette.success.main}),children:`${c}`}),e.jsx(L,{variant:"subtitle2",sx:T=>({color:T.palette.success.main}),children:`${n(b).format("HH:mm")}:${n(F).format("HH:mm")}`})]}),i&&e.jsxs(Rs,{children:[e.jsx(Y,{size:"small",onClick:()=>{v(g[u]),a()},children:e.jsx(ze,{fontSize:"small",color:"secondary"})}),e.jsx(Y,{size:"small",onClick:()=>{o(g[u]),l(!0)},children:e.jsx($e,{fontSize:"small",color:"error"})})]})]})]},u))]})})})})};Ee.propTypes={currentDay:t.array,handleAddALesson:t.func,isEdit:t.oneOfType([t.object,t.bool]),setIsEdit:t.func,open:t.bool,handleClose:t.func,language:t.string,isDay:t.oneOfType([t.object,t.oneOf([null])]),setDeleteItem:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,setEditItem:t.func};var me={},As=gt;Object.defineProperty(me,"__esModule",{value:!0});var Ve=me.default=void 0,qs=As(jt()),Ys=e;Ve=me.default=(0,qs.default)((0,Ys.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");const Ne=({permissions:r,setIsModal:s,setCurrentDay:p,shouldDisplay:a,props:x,language:o})=>{const i=bt(),l=w.useMemo(()=>a.sort((d,y)=>{const c=new Date(d.date),b=new Date(y.date);if(c-b!==0)return c-b;const F=new Date(d.startTime),u=new Date(y.startTime);return F-u}),[a]),v=()=>{!r&&!a||!r&&a.length===0||(s(!0),p(a))};return e.jsx(h,{children:e.jsxs(h,{position:"relative",children:[a.length===1&&e.jsx(h,{sx:{position:"absolute",top:-5,right:-5,zIndex:5},children:e.jsx(Ve,{fontSize:"small",sx:{color:i.palette.success.main}})}),e.jsx(h,{children:a.length>1&&e.jsx(h,{sx:d=>({position:"absolute",top:-2,right:-2,width:16,height:16,borderRadius:"50%",background:d.palette.secondary.main,display:"flex",justifyContent:"center",alignItems:"center",zIndex:5}),children:e.jsx(L,{variant:"caption",color:"#111",children:a.length})})}),e.jsx(Ye,{component:"div",classes:{tooltip:"custom-tooltip"},title:l.length>0&&e.jsx("div",{style:{maxHeight:100,overflow:"auto",scrollbarWidth:"thin",padding:5},children:l.map(({startTime:d,endTime:y,place:c})=>e.jsxs("div",{style:{padding:5},children:[e.jsxs(L,{variant:"subtitle2",textAlign:"center",component:"div",children:[o==="ua"?"Локація: ":"Location: ",c]}),e.jsxs(L,{variant:"subtitle2",textAlign:"center",component:"div",children:[o==="ua"?"Час: ":"Time: ",n(d).format("HH:mm"),":",n(y).format("HH:mm")]})]},yt()))}),placement:"top-end",children:e.jsx(Vt,{onClick:v,...x,sx:{border:x.today?`solid 2px ${i.palette.info.main} !important`:a.length>0&&`solid 2px ${i.palette.success.main}`}})})]})})};Ne.propTypes={props:t.object,today:t.bool,setIsModal:t.func,setCurrentDay:t.func,shouldDisplay:t.array,permissions:t.bool.isRequired,isEdit:t.oneOfType([t.object,t.bool]),language:t.string};function Ue({handleAddALesson:r,setIsDay:s,editItem:p,setEditItem:a,open:x,isDay:o,permissions:i,isDeleteModal:l,setIsDeleteModal:v,locationMonth:d,nameCollection:y,currentDay:c,setCurrentDay:b,setDeleteItem:F}){const[u,g]=w.useState(!1),T=S(O),m=S(_),j=S(Fe),M=ce(),k=()=>{s(null),g(!1)},D=()=>!(n(d).isBefore(n().format("YYYY-MM"))||n(`${d}`).isAfter(n().format("YYYY-MM"))),I=w.useMemo(()=>({day:C})=>j==null?void 0:j.filter(({date:R})=>n(C).isSame(n(R),"day")),[j]),q=w.memo(Ne);return e.jsx(h,{children:e.jsxs(z,{elevation:1,sx:{p:2,position:"relative",boxShadow:"0px 0px 4px -2px rgba(0,0,0,0.52)","& .MuiPickersDay-root.Mui-selected":!D()&&{backgroundColor:"transparent !important",color:"inherit !important"}},children:[e.jsx(Ae,{dateAdapter:qe,localeText:T==="ua"?Nt.components.MuiLocalizationProvider.defaultProps.localeText:Ut.components.MuiLocalizationProvider.defaultProps.localeText,adapterLocale:T==="ua"?"uk":"en",children:e.jsx(Gt,{disabled:m,value:n(d).isValid()?n(d).date(n().date()):null,onMonthChange:C=>{const R=`/lessons/${y}/${C.format("YYYY-MM")}`;location.pathname!==R&&M(R)},onChange:C=>s(C),views:["day"],loading:m,renderLoading:()=>e.jsx(Jt,{}),slots:{day:C=>{const R=I(C);return e.jsx(q,{permissions:i,setIsModal:g,shouldDisplay:R,props:C,language:T,setCurrentDay:b})}}},T)}),e.jsx(ps,{children:u&&e.jsx(Ee,{setDeleteItem:F,currentDay:c,open:x,editItem:p,setEditItem:a,handleClose:k,language:T,handleAddALesson:r,isDay:o,permissions:i,isDeleteModal:l,setIsDeleteModal:v})})]})})}Ue.propTypes={currentDay:t.array.isRequired,setCurrentDay:t.func.isRequired,handleAddALesson:t.func,setIsDay:t.func,isDay:t.oneOfType([t.object,t.oneOf([null])]),editItem:t.object,setEditItem:t.func,open:t.bool,setValueSelect:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,nameCollection:t.string.isRequired,locationMonth:t.string.isRequired,setDeleteItem:t.func.isRequired};const $s=["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],Ws=["January","February","March","April","May","June","July","August","September","October","November","December"],Bs=r=>r==="en"?Ws:$s;Ge.propTypes={nameCollection:t.string.isRequired,locationMonth:t.string.isRequired};function Ge({nameCollection:r,locationMonth:s}){const p=S(O),a=S(_),x=ce();return e.jsx(h,{sx:{maxWidth:400,width:"100%",p:"10px"},children:e.jsxs(xe,{fullWidth:!0,disabled:a,children:[e.jsx(We,{children:p==="en"?"Select a month":"Виберіть місяць"}),e.jsx(Be,{value:s,label:p==="en"?"Select a month":"Виберіть місяць",onChange:o=>{const i=`/lessons/${r}/${n(o.target.value).format("YYYY-MM")}`;location.pathname!==i&&(console.log("SelectMonth Navigating to:",i),x(i))},children:Bs(p).map((o,i)=>e.jsx(he,{value:`${new Date().getFullYear()}-${i+1<10?`0${i+1}`:i+1}`,children:o},o))})]})})}Je.propTypes={isLoading:t.bool.isRequired,language:t.string.isRequired,nameCollection:t.string.isRequired};function Je({isLoading:r,language:s,nameCollection:p}){const a=de(),x=S(Ie);return e.jsx("div",{children:e.jsxs(xe,{children:[e.jsx(cs,{children:s==="en"?"Show list":"Показувати список"}),e.jsxs(Qt,{row:!0,value:x["filter"+p]?x["filter"+p]:"Fully",onChange:o=>a(Tt({["filter"+p]:o.target.value})),children:[e.jsx(se,{disabled:r,value:"Fully",control:e.jsx(ne,{}),label:s==="en"?"Fully":"Повністю"}),e.jsx(se,{disabled:r,value:"Current week",control:e.jsx(ne,{}),label:s==="en"?"Current week":"Поточний тиждень"}),e.jsx(se,{disabled:r,value:"Hide past dates",control:e.jsx(ne,{}),label:s==="en"?"Hide past dates":"Приховати минулі дати"})]})]})})}Qe.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,permissions:t.bool.isRequired,nameCollection:t.string.isRequired,page:t.number.isRequired,setPage:t.func.isRequired,limit:t.number.isRequired,setLimit:t.func.isRequired,totalPages:t.number.isRequired,setTotalPages:t.func.isRequired,setEditItem:t.func.isRequired,setDeleteItem:t.func.isRequired,handleAddALesson:t.func.isRequired};function Qe({setIsDeleteModal:r,permissions:s,setDeleteItem:p,nameCollection:a,handleAddALesson:x,setEditItem:o,page:i,setPage:l,totalPages:v}){const d=S(O),y=S(Fe),c=S(_),b=S(Ie),F=(m,j)=>{l(j)},u=(m,j,M,k)=>{const D={td:{maxWidth:"600px",borderBottom:M||k?"none":null}},I=n().format("YYYY-MM-DD"),q=n().isAfter(n(j),"day");return I===n(j).format("YYYY-MM-DD")?(D.td.color=m.palette.info.dark,D):(q&&(D.td.color=m.palette.grey.A400,D.backgroundColor=m.palette.grey[500]+20),D)},g=[...y].sort((m,j)=>{const M=new Date(m.date),k=new Date(j.date);if(M-k!==0)return M-k;const D=new Date(m.startTime),I=new Date(j.startTime);return D-I}),T=()=>{let m=g;return(b["filter"+a]?b["filter"+a]:"Fully")==="Hide past dates"&&(m=m==null?void 0:m.filter(({date:j})=>n(j).isAfter(n())||n(j).isSame(n(),"day"))),(b["filter"+a]?b["filter"+a]:"Fully")==="Current week"&&(m=m==null?void 0:m.filter(({date:j})=>{const M=n(j),k=n().startOf("week"),D=n().endOf("week");return M.isAfter(k)&&M.isBefore(D)})),m};return e.jsxs(e.Fragment,{children:[e.jsx(Je,{isLoading:c,language:d,nameCollection:a}),e.jsxs(Zt,{elevation:2,sx:{boxShadow:"0px 0px 5px -2px rgba(0,0,0,0.52)",width:"100%",maxWidth:"800px"},component:z,children:[e.jsxs(Kt,{children:[e.jsx(Xt,{children:e.jsxs(U,{children:[e.jsx(A,{children:d==="ua"?"Дата":"Date"}),e.jsx(A,{children:d==="ua"?"Час":"Time"}),e.jsx(A,{sx:{whiteSpace:"nowrap"},children:d==="ua"?"Локація":"Location"}),s&&e.jsxs(e.Fragment,{children:[e.jsx(A,{align:"center",children:d==="en"?"Edit":"Редагувати"}),e.jsx(A,{align:"center",children:d==="en"?"Delete":"Видалити"})]})]})}),e.jsx(es,{children:T().length>0&&T().map(({_id:m,date:j,startTime:M,endTime:k,place:D,topic:I="",notes:q=""},C,R)=>e.jsxs(w.Fragment,{children:[e.jsxs(U,{id:m,sx:W=>u(W,j,I,q),children:[e.jsx(A,{children:n(j).format("DD.MM.YYYY")}),e.jsxs(A,{children:[n(M).format("HH:mm"),":",n(k).format("HH:mm")]}),e.jsx(A,{children:D}),s&&e.jsxs(e.Fragment,{children:[e.jsx(A,{align:"center",children:e.jsx(Y,{disabled:c,color:"secondary",onClick:()=>{o(R[C]),x()},children:e.jsx(ze,{})})}),e.jsx(A,{align:"center",children:e.jsx(Y,{disabled:c,color:"error",onClick:()=>{p(R[C]),r(!0)},children:e.jsx($e,{})})})]})]}),I&&e.jsx(U,{sx:W=>({...u(W,j),textAlign:"start",background:"inherit"}),children:e.jsxs(A,{colSpan:5,sx:{overflowWrap:"break-word",borderBottom:q?"none":null},children:["Topic: ",I]})}),q&&e.jsx(U,{sx:W=>({...u(W,j),textAlign:"start",background:"inherit"}),children:e.jsxs(A,{colSpan:5,sx:{overflowWrap:"break-word"},children:["Notes: ",q]})})]},C))})]}),v>1&&e.jsx(h,{width:"100%",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(xs,{count:v,variant:"outlined",color:"primary",disabled:c,page:i,boundaryCount:0,onChange:F})}),c&&e.jsx(h,{width:"100%",height:"100px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(pe,{})}),!c&&g.length===0&&e.jsx(L,{variant:"h6",textAlign:"center",marginBottom:2,mt:2,children:d==="en"?"Cleaning this month are not yet scheduled":"Прибирання в цьому місяці ще не заплановано"})]})]})}const zs=P(h)`
  margin-bottom: 20px;
  padding: 20px 0;
  width: 100%;
  display: flex;
  flex-wrap: nowrap;
  gap: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  scrollbar-width: thin;
`,De=P(h)`
  display: flex;
  align-items: center;
  height: 100%;
`,Hs=P(h)`
  display: flex;
  flex-direction: column;

  align-items: center;
  margin-top: 20px;
`,Os=P(z)`
  flex: 0 0 auto;
  width: 100%;
  max-width: 300px;
  height: 400px;
  overflow: hidden;
  border-radius: 4px;
`,_s=P(h)`
  width: 100%;
  height: 100%;
  max-width: 300px;
  max-height: 180px;
  display: flex;
  align-items: center;
  justify-content: center;
`,Es=P(h)`
  width: 100%;
  /* height: 100%; */
  max-width: 300px;
  max-height: 50px;
  display: flex;
  overflow: auto;
  scrollbar-width: thin;
`,Vs=P(h)`
  padding: 10px;
  width: 100%;
  height: 100%;
  max-height: 220px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;

  overflow: hidden;
`,Ns=P(h)`
  width: 100%;
  max-height: 120px;

  overflow: hidden;
`;Ze.propTypes={_id:t.string.isRequired,likedBy:t.array.isRequired,likes:t.number.isRequired,setIsLiking:t.func,nameCollection:t.string.isRequired};function Ze({_id:r,likedBy:s,likes:p,setIsLiking:a,nameCollection:x}){const o=de(),i=S(Le),l=S(wt),v=y=>{a&&a(!0),o(vt({postId:y,userId:i.uid,displayName:i.displayName,avatar:i.photoURL,nameCollection:x})).finally(()=>{a&&a(!1)})},d=y=>y.length>0?y==null?void 0:y.findIndex(c=>c.userId===(i==null?void 0:i.uid)):-1;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",justifyContent:"flex-end"},children:[e.jsx(Y,{disabled:!l,onClick:()=>v(r),color:d(s)!==-1?"error":"default",children:e.jsx(fs,{sx:{transition:"transform 0.2s",transform:d(s)!==-1?"scale(1.2)":"scale(1)"}})}),e.jsx(L,{variant:"body1",children:p})]})}Ke.propTypes={postsArr:t.array.isRequired,nameCollection:t.string.isRequired};function Ke({postsArr:r,nameCollection:s}){return e.jsx(e.Fragment,{children:r.map(({title:p,_id:a,posters:x,description:o,likes:i,likedBy:l,createdAt:v},d)=>e.jsxs(Os,{id:d===0?"firstPost":void 0,children:[(x==null?void 0:x.length)>0?e.jsx(bs,{images:x,variant:"post"}):e.jsx(_s,{children:e.jsx(ys,{fontSize:"large"})}),e.jsxs(Vs,{children:[e.jsx(Es,{children:e.jsx(Ce,{to:`/post/${s}/${a}`,style:{textDecoration:"none"},children:e.jsx(L,{variant:"body2",textAlign:"center",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:p})})}),e.jsx(Ns,{children:e.jsxs(L,{variant:"caption",textOverflow:"ellipsis",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[e.jsx(Ts,{children:o}),o]})}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[v&&e.jsx(L,{variant:"caption",children:n(v).format("DD-MM-YYYY")}),a&&l&&e.jsx(Ze,{_id:a,likedBy:l,likes:i,nameCollection:s})]})]})]},a))})}const Us=({permissions:r,nameCollection:s,image:p,placeList:a,mainTitle:x,defaultCategory:o=null})=>{const i=S(O),l=S(St),[v,d]=w.useState(!1),{displayName:y="No name",uid:c="No ID"}=S(Le)||{},b=S(Pt(s)),F=ve("(min-width:1100px)"),u=ve("(min-width:600px)"),g=ce(),T=Mt(),m=de(),j=T.pathname.split("/")[3],[M,k]=w.useState({}),[D,I]=w.useState({}),[q,C]=w.useState([]),[R,W]=w.useState(n()),[fe,E]=w.useState(!1),[J,Q]=w.useState(!1),[Z,Xe]=w.useState(1),[K,et]=w.useState(100),[tt,ge]=w.useState(1),[$,je]=w.useState(1),[be]=w.useState(10),[X,st]=w.useState(1),[nt,ee]=w.useState(!1),rt=w.useRef(null),at=()=>ee(!0),it=()=>ee(!1),ye=()=>E(!0),Te=()=>{if(b.length>0){const f=document.getElementById("firstPost");f&&window.requestAnimationFrame(()=>{f.scrollIntoView({behavior:"smooth",block:"start"})})}},ot=()=>{$<X&&(je($+1),Te())},lt=()=>{$>1&&(je($-1),Te())},ct=async f=>{if(!(f!=null&&f.date)||!(f!=null&&f.startTime)||!(f!=null&&f.endTime))return;const B=n(f.date).startOf("day").toISOString(),te=n(f.date).hour(n(f.startTime).hour()).minute(n(f.startTime).minute()).toISOString(),V=n(f.date).hour(n(f.endTime).hour()).minute(n(f.endTime).minute()).toISOString();if(n(te).isAfter(n(V))){It("error",i==="ua"?"Час закінчення не може бути раніше початку!":"End time cannot be earlier than start time!");return}const we={date:B,startTime:te,endTime:V,place:f.place,topic:f.topic,notes:f.notes,adder:{displayName:y,uid:c}};if(M._id){m(Lt({id:M._id,language:i,nameCollection:s,updateValue:we})).finally(()=>{E(!1),k({})});return}else m(Rt({language:i,nameCollection:s,data:we})).finally(()=>E(!1))};return w.useEffect(()=>{const f=Se.CancelToken.source(),B=`/lessons/${s}/${j}`;return T.pathname!==B&&g(B),(async()=>{try{await m(Ct({nameCollection:s,locationMonth:j,cancelToken:f,setTotalPages:ge,page:Z,limit:K}))}catch(V){console.error("Ошибка при загрузке расписания:",V)}})(),()=>f.cancel("Компонент размонтирован или маршрут изменен")},[m,K,T.pathname,j,s,g,Z]),w.useEffect(()=>{const f=Se.CancelToken.source();return(async()=>{m(Ft({nameCollection:s,tag:s,page:$,limit:be,cancelToken:f,setTotalPages:st}))})(),()=>f.cancel("Компонент размонтирован или параметры постов изменены")},[m,s,$,be]),e.jsxs(e.Fragment,{children:[e.jsx(Dt,{}),e.jsxs(h,{sx:{mb:5,width:"100%"},children:[e.jsx(ts,{image:p,title:x}),e.jsxs(h,{display:"flex",width:"100%",gap:"40px",mt:"40px",flexWrap:F?"nowrap":"wrap",justifyContent:"center",children:[e.jsx(Ue,{nameCollection:s,locationMonth:j,handleAddALesson:ye,setIsDay:W,setEditItem:k,editItem:M,open:fe,isDay:R,currentDay:q,setCurrentDay:C,permissions:r,isDeleteModal:J,setIsDeleteModal:Q,setDeleteItem:I}),e.jsx(z,{elevation:u?1:0,sx:{padding:u?5:"30px 0 0 0",width:"100%",boxShadow:"0px 0px 3px -2px rgba(0,0,0,0.82)"},children:e.jsxs(h,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:"30px",children:[e.jsx(z,{elevation:2,sx:{width:"100%",maxWidth:"400px",boxShadow:"0px 0px 3px -2px rgba(0,0,0,0.82)"},children:e.jsx(Ge,{nameCollection:s,locationMonth:j})}),e.jsx(Qe,{nameCollection:s,page:Z,setPage:Xe,limit:K,setLimit:et,totalPages:tt,setTotalPages:ge,permissions:r,isDeleteModal:J,setIsDeleteModal:Q,handleAddALesson:ye,setEditItem:k,setDeleteItem:I}),Pe[s]&&e.jsx(Ye,{title:i==="en"?"Open a group in Telegram":"Відкрити групу в Telegram",children:e.jsx(ss,{href:Pe[s]??null,target:"_blank",rel:"noopener noreferrer",children:e.jsxs(ns,{component:"div",variant:"button",children:[i==="en"?"JOIN":"ПРИЕДНАТИСЯ",e.jsx(rs,{color:"info",fontSize:"large"})]})})})]})})]}),e.jsxs(Hs,{children:[e.jsx(zs,{ref:rt,children:l?e.jsx(h,{display:"flex",gap:"10px",children:[...Array(5)].map((f,B)=>e.jsxs(z,{sx:{p:2,mb:2,width:"300px",flexShrink:"0"},children:[e.jsx(re,{variant:"rectangular",width:"100%",height:150}),e.jsx(re,{width:"60%"}),e.jsx(re,{width:"80%"})]},B))}):e.jsx(e.Fragment,{children:(b==null?void 0:b.length)>0&&e.jsxs(e.Fragment,{children:[X>1&&$>1&&e.jsx(De,{children:e.jsx(Y,{size:"large",onClick:lt,disabled:$===1,children:e.jsx(gs,{fontSize:"large"})})}),e.jsx(Ke,{postsArr:b,nameCollection:s}),X!==$&&e.jsx(De,{children:e.jsx(Y,{size:"large",onClick:ot,children:e.jsx(js,{fontSize:"large"})})})]})})}),r&&e.jsx(G,{variant:"contained",onClick:at,children:kt.addPost[i]})]}),e.jsx(ke,{open:v,sx:{color:"#fff",zIndex:f=>f.zIndex.drawer+1},children:e.jsx(pe,{color:"inherit"})}),e.jsx(le,{open:nt,onClose:it,closeAfterTransition:!0,children:e.jsx(hs,{children:e.jsx(ms,{nameCollection:s,setOpen:ee,setLoading:d,defaultTag:s,defaultCategory:o})})}),e.jsx(_e,{open:fe,setOpen:E,onSubmit:ct,placeList:a,isDay:R,editItem:M,setEditItem:k}),e.jsx(Oe,{dispatch:m,isDeleteModal:J,setIsDeleteModal:Q,nameCollection:s,deleteItem:D,setDeleteItem:I})]})]})};Us.propTypes={permissions:t.bool.isRequired,nameCollection:t.string.isRequired,image:t.string.isRequired,placeList:t.array.isRequired,mainTitle:t.string.isRequired,defaultCategory:t.string};export{Us as default};
