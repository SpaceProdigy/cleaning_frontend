import{r as w,_ as ot,aY as lt,H as V,j as e,s as P,B as h,u as S,b as _,M as le,I as Y,T as F,d as n,i as U,aZ as ct,a as t,a_ as G,l as Se,N as De,aa as dt,P as H,az as ut,aA as pt,a5 as xt,v as ht,w as mt,aB as ft,an as gt,a$ as Me,p as ke,f as ce,aE as Ce,aF as jt,W as Ie,o as bt,a1 as yt,Y as Tt,c as wt,aV as ye,aL as vt,g as Te,A as Pt,k as St,b0 as Dt,b1 as Mt,a0 as kt,b2 as Ct,b3 as It}from"./index-DHMYHPLJ.js";import{P as Lt,I as Ft}from"./ImageTitle-Df3CRtH2.js";import{p as Rt,s as Le,q as At,r as qt,v as Yt,w as $t,x as Wt,y as Bt,z as zt,B as Ht,L as Fe,A as Re,j as _t,C as Et,T as Ae,P as Ot,u as Vt,e as Nt,D as Ut,a as Gt,R as Zt,F as se,b as ne,c as Jt,d as Qt,f as Kt,g as N,h as A,i as Xt,t as we,m as es,n as ts,o as ss,E as re}from"./Rulse.styled-C9eEfHI2.js";import{d as de}from"./Close-Cv2GWILu.js";import{u as ns,C as z}from"./index.esm---gkGG6j.js";import{o as rs,c as as,a as ae,b as ie}from"./index.esm-DH0sSN5I.js";import{C as ue}from"./CircularProgress-H7wfKakC.js";import{T as oe,d as qe}from"./Delete-BtaQkjJX.js";import{F as Ye,I as is,a as os,b as ls}from"./OutlinedInput-ZIR4bm_w.js";import{S as cs,M as $e,a as ds}from"./Select-BXdZ8q5V.js";import{a as us,d as We}from"./Edit-BENwgoGo.js";import{A as ps}from"./index-BO554RG0.js";import{b as xs,c as hs}from"./PostFileUploader-BrTUKv9v.js";import{b as ms,d as fs,a as gs}from"./Favorite-BltDL79k.js";import{I as js,d as bs}from"./ImageNotSupported-CF6Mfmmd.js";import{U as ys}from"./UniversalReactMarkdown-CJKpkJ5k.js";import"./errorMessages-r0iQUu04.js";import"./createStyled-BjQUDIHu.js";import"./Link-BtZ7P339.js";import"./CloudUpload-CORyO0e-.js";const Be=({adapter:r,value:s,timezone:x,props:a})=>{if(s===null)return null;const{minTime:p,maxTime:i,minutesStep:o,shouldDisableTime:l,disableIgnoringDatePartForTimeValidation:v=!1,disablePast:u,disableFuture:y}=a,c=r.utils.date(void 0,x),j=Rt(v,r.utils);switch(!0){case!r.utils.isValid(s):return"invalidDate";case!!(p&&j(p,s)):return"minTime";case!!(i&&j(s,i)):return"maxTime";case!!(y&&r.utils.isAfter(s,c)):return"disableFuture";case!!(u&&r.utils.isBefore(s,c)):return"disablePast";case!!(l&&l(s,"hours")):return"shouldDisableTime-hours";case!!(l&&l(s,"minutes")):return"shouldDisableTime-minutes";case!!(l&&l(s,"seconds")):return"shouldDisableTime-seconds";case!!(o&&r.utils.getMinutes(s)%o!==0):return"minutesStep";default:return null}};Be.valueManager=Le;const Ts=r=>{const s=At(r),{forwardedProps:x,internalProps:a}=qt(s,"time");return Yt({forwardedProps:x,internalProps:a,valueManager:Le,fieldValueManager:$t,validator:Be,valueType:"time"})},ws=["slots","slotProps","InputProps","inputProps"],ve=w.forwardRef(function(s,x){const a=Wt({props:s,name:"MuiTimeField"}),{slots:p,slotProps:i,InputProps:o,inputProps:l}=a,v=ot(a,ws),u=a,y=(p==null?void 0:p.textField)??(s.enableAccessibleFieldDOMStructure?Bt:oe),c=lt({elementType:y,externalSlotProps:i==null?void 0:i.textField,externalForwardedProps:v,ownerState:u,additionalProps:{ref:x}});c.inputProps=V({},l,c.inputProps),c.InputProps=V({},o,c.InputProps);const j=Ts(c),I=zt(j),d=Ht(V({},I,{slots:p,slotProps:i}));return e.jsx(y,V({},d))}),vs=P(h)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:r})=>r.palette.background.paper};
  box-shadow: ${({theme:r})=>r.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ps=P(h)`
  position: absolute;
  right: 5px;
  top: 5px;
`;ze.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,deleteItem:t.object.isRequired,dispatch:t.func,nameCollection:t.string.isRequired,setDeleteItem:t.func.isRequired};function ze({isDeleteModal:r,setIsDeleteModal:s,deleteItem:x,dispatch:a,nameCollection:p,setDeleteItem:i}){const o=S(_);return e.jsx(le,{open:r,onClose:()=>{s(!1)},children:e.jsxs(vs,{children:[e.jsx(Ps,{children:e.jsx(Y,{onClick:()=>{s(!1)},children:e.jsx(de,{})})}),e.jsxs(h,{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",children:[x&&e.jsx(F,{variant:"subtitle2",textAlign:"center",sx:l=>({color:l.palette.warning.main}),children:`${n(x.date).format("DD.MM.YYYY")} ${o==="ua"?"Локація:":"Location:"} ${x.place}, ${o==="ua"?"Час: ":"Time: "}
            ${n(x.startTime).format("HH:mm")}:   ${n(x.endTime).format("HH:mm")}`}),e.jsx(F,{variant:"subtitle2",textAlign:"center",sx:l=>({color:l.palette.error.main}),children:o==="en"?"Warning: If you delete this lesson, it cannot be restored.":"Попередження: якщо ви видалите цей урок, його не можна буде відновити."}),e.jsxs(h,{display:"flex",gap:"20px",children:[e.jsx(U,{onClick:()=>s(!1),children:o==="en"?"Close":"Закрити"}),e.jsx(U,{onClick:()=>{a(ct({nameCollection:p,language:o,id:x._id})).finally(()=>i({})),s(!1)},children:o==="en"?"Delete":"Видалити"})]})]})]})})}const Ss=P(h)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:r})=>r.palette.background.paper};
  box-shadow: ${({theme:r})=>r.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ds=P(h)`
  position: absolute;
  right: 5px;
  top: 5px;
`,Ms=r=>as({date:ie().required(r==="ua"?"Дата обов'язкова":"Date is required"),startTime:ie().required(r==="ua"?"Час обов'язковий":"Time is required"),endTime:ie().required(r==="ua"?"Час закінчення обов'язковий":"End time is required").test("is-after",r==="ua"?"Час закінчення повинен бути після початку":"End time must be after start time",function(s){const{startTime:x}=this.parent;return n(s).isAfter(n(x))}),place:ae().required(r==="ua"?"Оберіть місце":"Choose a location"),topic:ae().max(100,r==="ua"?"Максимум 100 символів":"Max 100 characters"),notes:ae().max(500,r==="ua"?"Максимум 500 символів":"Max 500 characters")});He.propTypes={open:t.bool,setOpen:t.func,onSubmit:t.func,isDay:t.object,placeList:t.array.isRequired,editItem:t.object,setEditItem:t.func};function He({open:r,setOpen:s,onSubmit:x,placeList:a,isDay:p,editItem:i,setEditItem:o}){const l=S(_),v=S(G),{control:u,handleSubmit:y,formState:{errors:c},reset:j}=ns({resolver:rs(Ms(l)),defaultValues:{date:p||n(),startTime:n().hour(17).minute(30),endTime:n().hour(19).minute(0),place:a[0].en,topic:"",notes:""},mode:"onChange"}),I=d=>{x(d).finally(()=>j())};return w.useEffect(()=>{(()=>{if(i!=null&&i._id)return j({date:n(i.date).startOf("day"),startTime:n(i.startTime).hour(n(i.startTime).hour()).minute(n(i.startTime).minute()),endTime:n(i.endTime).hour(n(i.endTime).hour()).minute(n(i.endTime).minute()),place:i.place,topic:i.topic,notes:i.notes});if(p)return j({date:p||n(),startTime:n().hour(17).minute(30),endTime:n().hour(19).minute(0),place:a[0].en,topic:"",notes:""})})()},[i,p,a,j,o]),e.jsx(le,{open:r,onClose:()=>s(!1),children:e.jsxs(Ss,{children:[e.jsx(Se,{open:v,sx:{color:"#fff",zIndex:d=>d.zIndex.modal+1,backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsx(ue,{color:"inherit"})}),e.jsx(Ds,{children:e.jsx(Y,{onClick:()=>s(!1),children:e.jsx(de,{})})}),e.jsxs("form",{onSubmit:y(I),style:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:400},children:[e.jsxs(Fe,{dateAdapter:Re,children:[e.jsx(z,{name:"date",control:u,render:({field:d})=>{var g;return e.jsx(_t,{...d,label:l==="ua"?"Дата":"Date",format:"DD.MM.YYYY",value:d.value||null,onChange:T=>d.onChange(T||n()),slotProps:{textField:{fullWidth:!0,error:!!c.date,helperText:(g=c.date)==null?void 0:g.message,sx:{mb:2}}}})}}),e.jsx(z,{name:"startTime",control:u,render:({field:d})=>{var g;return e.jsx(ve,{...d,label:l==="ua"?"Початок":"Start Time",format:"HH:mm",value:d.value||null,onChange:T=>d.onChange(T||n()),slotProps:{textField:{fullWidth:!0,error:!!c.time,helperText:(g=c.time)==null?void 0:g.message,sx:{mb:2}}}})}}),e.jsx(z,{name:"endTime",control:u,render:({field:d})=>{var g;return e.jsx(ve,{...d,label:l==="ua"?"Час закінчення":"End Time",format:"HH:mm",value:d.value||null,onChange:T=>d.onChange(T||n()),slotProps:{textField:{fullWidth:!0,error:!!c.endTime,helperText:(g=c.endTime)==null?void 0:g.message,sx:{mb:2}}}})}})]}),e.jsx(z,{name:"place",control:u,render:({field:d})=>{var g;return e.jsxs(Ye,{sx:{width:"100%",maxWidth:400,mb:2},error:!!c.place,children:[e.jsx(is,{children:l==="ua"?"Виберіть локацію":"Choose a location"}),e.jsx(cs,{...d,label:l==="ua"?"Виберіть локацію":"Choose a location",children:a.map((T,m)=>e.jsx($e,{value:T.en,children:T[l]},m))}),e.jsx(os,{children:(g=c.place)==null?void 0:g.message})]})}}),e.jsx(z,{name:"topic",control:u,render:({field:d})=>{var g;return e.jsx(oe,{...d,label:l==="ua"?"Тема заняття":"Lesson Topic",fullWidth:!0,sx:{mb:2},error:!!c.topic,helperText:((g=c.topic)==null?void 0:g.message)||(l==="ua"?"Максимум 100 символів":"Max 100 characters")})}}),e.jsx(z,{name:"notes",control:u,render:({field:d})=>{var g;return e.jsx(oe,{...d,label:l==="ua"?"Нотатки":"Notes",fullWidth:!0,multiline:!0,rows:3,sx:{mb:2},error:!!c.notes,helperText:((g=c.notes)==null?void 0:g.message)||(l==="ua"?"Максимум 500 символів":"Max 500 characters")})}}),e.jsx(U,{type:"submit",variant:"contained",fullWidth:!0,size:"large",children:l==="en"?"Submit":"Додати"})]})]})})}const ks=P(h)`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 16px;
`,Cs=P(h)`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;

  padding: 5px 0px;
`;P(h)`
  width: 100%;
  display: flex;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
  color: ${({theme:r})=>r.palette.warning.main};
`;const Is=P(h)`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
`,Ls=P(h)`
  display: flex;
  flex-direction: column;
  /* align-items: center; */
  gap: 5px;
  white-space: nowrap;
`,Fs=P(h)`
  display: flex;
  align-items: center;
  gap: 12px;
  white-space: nowrap;
`;P(De)`
  text-decoration: none;
  color: transparent;
`;const _e=({currentDay:r,handleClose:s,language:x,handleAddALesson:a,isDay:p,setDeleteItem:i,permissions:o,setIsDeleteModal:l,setEditItem:v})=>{const[u]=w.useState(!1),y=S(G);return e.jsx(dt.div,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:100},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(H,{elevation:2,children:e.jsx(Et,{onClickAway:()=>{u||s()},children:e.jsxs(h,{children:[e.jsxs(ks,{children:[e.jsx(F,{variant:"subtitle2",children:n(p).format("YYYY-MM-DD")}),e.jsx(Y,{onClick:s,size:"small",children:e.jsx(de,{fontSize:"small"})})]}),o&&e.jsx(e.Fragment,{children:e.jsx(ds,{children:e.jsxs($e,{disabled:y,onClick:()=>{v({}),a()},children:[e.jsx(ut,{children:x==="en"?"Add Lesson":"Додайти урок"}),e.jsx(pt,{sx:{ml:2},children:e.jsx(us,{color:"success"})})]})})}),r==null?void 0:r.map(({place:c,startTime:j,endTime:I},d,g)=>e.jsxs(Cs,{children:[e.jsx(xt,{sx:{width:"100%"}}),e.jsxs(Is,{children:[e.jsxs(Ls,{children:[e.jsx(F,{variant:"subtitle2",sx:T=>({color:T.palette.success.main}),children:`${c}`}),e.jsx(F,{variant:"subtitle2",sx:T=>({color:T.palette.success.main}),children:`${n(j).format("HH:mm")}:${n(I).format("HH:mm")}`})]}),o&&e.jsxs(Fs,{children:[e.jsx(Y,{size:"small",onClick:()=>{v(g[d]),a()},children:e.jsx(We,{fontSize:"small",color:"secondary"})}),e.jsx(Y,{size:"small",onClick:()=>{i(g[d]),l(!0)},children:e.jsx(qe,{fontSize:"small",color:"error"})})]})]})]},d))]})})})})};_e.propTypes={currentDay:t.array,handleAddALesson:t.func,isEdit:t.oneOfType([t.object,t.bool]),setIsEdit:t.func,open:t.bool,handleClose:t.func,language:t.string,isDay:t.oneOfType([t.object,t.oneOf([null])]),setDeleteItem:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,setEditItem:t.func};var pe={},Rs=ht;Object.defineProperty(pe,"__esModule",{value:!0});var Ee=pe.default=void 0,As=Rs(mt()),qs=e;Ee=pe.default=(0,As.default)((0,qs.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");const Oe=({permissions:r,setIsModal:s,setCurrentDay:x,shouldDisplay:a,props:p,language:i})=>{const o=ft(),l=w.useMemo(()=>a.sort((u,y)=>{const c=new Date(u.date),j=new Date(y.date);if(c-j!==0)return c-j;const I=new Date(u.startTime),d=new Date(y.startTime);return I-d}),[a]),v=()=>{!r&&!a||!r&&a.length===0||(s(!0),x(a))};return e.jsx(h,{children:e.jsxs(h,{position:"relative",children:[a.length===1&&e.jsx(h,{sx:{position:"absolute",top:-5,right:-5,zIndex:5},children:e.jsx(Ee,{fontSize:"small",sx:{color:o.palette.success.main}})}),e.jsx(h,{children:a.length>1&&e.jsx(h,{sx:u=>({position:"absolute",top:-2,right:-2,width:16,height:16,borderRadius:"50%",background:u.palette.secondary.main,display:"flex",justifyContent:"center",alignItems:"center",zIndex:5}),children:e.jsx(F,{variant:"caption",color:"#111",children:a.length})})}),e.jsx(Ae,{component:"div",classes:{tooltip:"custom-tooltip"},title:l.length>0&&e.jsx("div",{style:{maxHeight:100,overflow:"auto",scrollbarWidth:"thin",padding:5},children:l.map(({startTime:u,endTime:y,place:c})=>e.jsxs("div",{style:{padding:5},children:[e.jsxs(F,{variant:"subtitle2",textAlign:"center",component:"div",children:[i==="ua"?"Локація: ":"Location: ",c]}),e.jsxs(F,{variant:"subtitle2",textAlign:"center",component:"div",children:[i==="ua"?"Час: ":"Time: ",n(u).format("HH:mm"),":",n(y).format("HH:mm")]})]},gt()))}),placement:"top-end",children:e.jsx(Ot,{onClick:v,...p,sx:{border:p.today?`solid 2px ${o.palette.info.main} !important`:a.length>0&&`solid 2px ${o.palette.success.main}`,background:p.today&&`${o.palette.info.main} !important`}})})]})})};Oe.propTypes={props:t.object,today:t.bool,setIsModal:t.func,setCurrentDay:t.func,shouldDisplay:t.array,permissions:t.bool.isRequired,isEdit:t.oneOfType([t.object,t.bool]),language:t.string};function Ve({handleAddALesson:r,setIsDay:s,editItem:x,setEditItem:a,open:p,isDay:i,permissions:o,isDeleteModal:l,setIsDeleteModal:v,locationMonth:u,nameCollection:y,currentDay:c,setCurrentDay:j,setDeleteItem:I}){const[d,g]=w.useState(!1),T=S(_),m=S(G),b=S(Me),D=ke(),k=()=>{s(null),g(!1)},M=()=>!(n(u).isBefore(n().format("YYYY-MM"))||n(`${u}`).isAfter(n().format("YYYY-MM"))),L=w.useMemo(()=>({day:C})=>b==null?void 0:b.filter(({date:R})=>n(C).isSame(n(R),"day")),[b]),q=w.memo(Oe);return e.jsx(h,{children:e.jsxs(H,{elevation:1,sx:{p:2,position:"relative",boxShadow:"0px 0px 4px -2px rgba(0,0,0,0.52)","& .MuiPickersDay-root.Mui-selected":!M()&&{backgroundColor:"transparent !important",color:"inherit !important"}},children:[e.jsx(Fe,{dateAdapter:Re,localeText:T==="ua"?Vt.components.MuiLocalizationProvider.defaultProps.localeText:Nt.components.MuiLocalizationProvider.defaultProps.localeText,adapterLocale:T==="ua"?"uk":"en",children:e.jsx(Ut,{disabled:m,value:null,onMonthChange:C=>{const R=`/lessons/${y}/${C.format("YYYY-MM")}`;location.pathname!==R&&D(R)},onChange:C=>s(C),views:["day"],loading:m,renderLoading:()=>e.jsx(Gt,{}),slots:{day:C=>{const R=L(C);return e.jsx(q,{permissions:o,setIsModal:g,shouldDisplay:R,props:C,language:T,setCurrentDay:j})}}},T)}),e.jsx(ps,{children:d&&e.jsx(_e,{setDeleteItem:I,currentDay:c,open:p,editItem:x,setEditItem:a,handleClose:k,language:T,handleAddALesson:r,isDay:i,permissions:o,isDeleteModal:l,setIsDeleteModal:v})})]})})}Ve.propTypes={currentDay:t.array.isRequired,setCurrentDay:t.func.isRequired,handleAddALesson:t.func,setIsDay:t.func,isDay:t.oneOfType([t.object,t.oneOf([null])]),editItem:t.object,setEditItem:t.func,open:t.bool,setValueSelect:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,nameCollection:t.string.isRequired,locationMonth:t.string.isRequired,setDeleteItem:t.func.isRequired};Ne.propTypes={isLoading:t.bool.isRequired,language:t.string.isRequired,nameCollection:t.string.isRequired};function Ne({isLoading:r,language:s,nameCollection:x}){const a=ce(),p=S(Ce);return e.jsx("div",{children:e.jsxs(Ye,{children:[e.jsx(ls,{children:s==="en"?"Show list":"Показувати список"}),e.jsxs(Zt,{row:!0,value:p["filter"+x]?p["filter"+x]:"Fully",onChange:i=>a(jt({["filter"+x]:i.target.value})),children:[e.jsx(se,{disabled:r,value:"Fully",control:e.jsx(ne,{}),label:s==="en"?"Fully":"Повністю"}),e.jsx(se,{disabled:r,value:"Current week",control:e.jsx(ne,{}),label:s==="en"?"Current week":"Поточний тиждень"}),e.jsx(se,{disabled:r,value:"Hide past dates",control:e.jsx(ne,{}),label:s==="en"?"Hide past dates":"Приховати минулі дати"})]})]})})}Ue.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,permissions:t.bool.isRequired,nameCollection:t.string.isRequired,page:t.number.isRequired,setPage:t.func.isRequired,limit:t.number.isRequired,setLimit:t.func.isRequired,totalPages:t.number.isRequired,setTotalPages:t.func.isRequired,setEditItem:t.func.isRequired,setDeleteItem:t.func.isRequired,handleAddALesson:t.func.isRequired};function Ue({setIsDeleteModal:r,permissions:s,setDeleteItem:x,nameCollection:a,handleAddALesson:p,setEditItem:i,page:o,setPage:l,totalPages:v}){const u=S(_),y=S(Me),c=S(G),j=S(Ce),I=(m,b)=>{l(b)},d=(m,b,D,k)=>{const M={td:{maxWidth:"600px",borderBottom:D||k?"none":null}},L=n().format("YYYY-MM-DD"),q=n().isAfter(n(b),"day");return L===n(b).format("YYYY-MM-DD")?(M.td.color=m.palette.info.dark,M):(q&&(M.td.color=m.palette.grey.A400,M.backgroundColor=m.palette.grey[500]+20),M)},g=[...y].sort((m,b)=>{const D=new Date(m.date),k=new Date(b.date);if(D-k!==0)return D-k;const M=new Date(m.startTime),L=new Date(b.startTime);return M-L}),T=()=>{let m=g;return(j["filter"+a]?j["filter"+a]:"Fully")==="Hide past dates"&&(m=m==null?void 0:m.filter(({date:b})=>n(b).isAfter(n())||n(b).isSame(n(),"day"))),(j["filter"+a]?j["filter"+a]:"Fully")==="Current week"&&(m=m==null?void 0:m.filter(({date:b})=>{const D=n(b),k=n().startOf("week"),M=n().endOf("week");return D.isAfter(k)&&D.isBefore(M)})),m};return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{isLoading:c,language:u,nameCollection:a}),e.jsxs(Jt,{elevation:2,sx:{boxShadow:"0px 0px 5px -2px rgba(0,0,0,0.52)",width:"100%",maxWidth:"800px"},component:H,children:[e.jsxs(Qt,{children:[e.jsx(Kt,{children:e.jsxs(N,{children:[e.jsx(A,{children:u==="ua"?"Дата":"Date"}),e.jsx(A,{children:u==="ua"?"Час":"Time"}),e.jsx(A,{sx:{whiteSpace:"nowrap"},children:u==="ua"?"Локація":"Location"}),s&&e.jsxs(e.Fragment,{children:[e.jsx(A,{align:"center",children:u==="en"?"Edit":"Редагувати"}),e.jsx(A,{align:"center",children:u==="en"?"Delete":"Видалити"})]})]})}),e.jsx(Xt,{children:T().length>0&&T().map(({_id:m,date:b,startTime:D,endTime:k,place:M,topic:L="",notes:q=""},C,R)=>e.jsxs(w.Fragment,{children:[e.jsxs(N,{id:m,sx:W=>d(W,b,L,q),children:[e.jsx(A,{children:n(b).format("DD.MM.YYYY")}),e.jsxs(A,{children:[n(D).format("HH:mm"),":",n(k).format("HH:mm")]}),e.jsx(A,{children:M}),s&&e.jsxs(e.Fragment,{children:[e.jsx(A,{align:"center",children:e.jsx(Y,{disabled:c,color:"secondary",onClick:()=>{i(R[C]),p()},children:e.jsx(We,{})})}),e.jsx(A,{align:"center",children:e.jsx(Y,{disabled:c,color:"error",onClick:()=>{x(R[C]),r(!0)},children:e.jsx(qe,{})})})]})]}),L&&e.jsx(N,{sx:W=>({...d(W,b),textAlign:"start",background:"inherit"}),children:e.jsxs(A,{colSpan:5,sx:{overflowWrap:"break-word",borderBottom:q?"none":null},children:["Topic: ",L]})}),q&&e.jsx(N,{sx:W=>({...d(W,b),textAlign:"start",background:"inherit"}),children:e.jsxs(A,{colSpan:5,sx:{overflowWrap:"break-word"},children:["Notes: ",q]})})]},C))})]}),v>1&&e.jsx(h,{width:"100%",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(Lt,{count:v,variant:"outlined",color:"primary",disabled:c,page:o,boundaryCount:0,onChange:I})}),c&&e.jsx(h,{width:"100%",height:"100px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(ue,{})}),!c&&g.length===0&&e.jsx(F,{variant:"h6",textAlign:"center",marginBottom:2,mt:2,children:u==="en"?"Cleaning this month are not yet scheduled":"Прибирання в цьому місяці ще не заплановано"})]})]})}const Ys=P(h)`
  margin-bottom: 20px;
  padding: 20px 0;
  width: 100%;
  display: flex;
  flex-wrap: nowrap;
  gap: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  scrollbar-width: thin;
`,Pe=P(h)`
  display: flex;
  align-items: center;
  height: 100%;
`,$s=P(h)`
  display: flex;
  flex-direction: column;

  align-items: center;
  margin-top: 20px;
`,Ws=P(H)`
  flex: 0 0 auto;
  width: 100%;
  max-width: 300px;
  height: 400px;
  overflow: hidden;
  border-radius: 4px;
`,Bs=P(h)`
  width: 100%;
  height: 100%;
  max-width: 300px;
  max-height: 180px;
  display: flex;
  align-items: center;
  justify-content: center;
`,zs=P(h)`
  width: 100%;
  /* height: 100%; */
  max-width: 300px;
  max-height: 50px;
  display: flex;
  overflow: auto;
  scrollbar-width: thin;
`,Hs=P(h)`
  padding: 10px;
  width: 100%;
  height: 100%;
  max-height: 220px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;

  overflow: hidden;
`,_s=P(h)`
  width: 100%;
  max-height: 120px;

  overflow: hidden;
`;Ge.propTypes={_id:t.string.isRequired,likedBy:t.array.isRequired,likes:t.number.isRequired,setIsLiking:t.func,nameCollection:t.string.isRequired};function Ge({_id:r,likedBy:s,likes:x,setIsLiking:a,nameCollection:p}){const i=ce(),o=S(Ie),l=S(bt),v=y=>{a&&a(!0),i(yt({postId:y,userId:o.uid,displayName:o.displayName,avatar:o.photoURL,nameCollection:p})).finally(()=>{a&&a(!1)})},u=y=>y.length>0?y==null?void 0:y.findIndex(c=>c.userId===(o==null?void 0:o.uid)):-1;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",justifyContent:"flex-end"},children:[e.jsx(Y,{disabled:!l,onClick:()=>v(r),color:u(s)!==-1?"error":"default",children:e.jsx(ms,{sx:{transition:"transform 0.2s",transform:u(s)!==-1?"scale(1.2)":"scale(1)"}})}),e.jsx(F,{variant:"body1",children:x})]})}Ze.propTypes={postsArr:t.array.isRequired,nameCollection:t.string.isRequired};function Ze({postsArr:r,nameCollection:s}){return e.jsx(e.Fragment,{children:r.map(({title:x,_id:a,posters:p,description:i,likes:o,likedBy:l,createdAt:v},u)=>e.jsxs(Ws,{id:u===0?"firstPost":void 0,children:[(p==null?void 0:p.length)>0?e.jsx(js,{images:p,variant:"post"}):e.jsx(Bs,{children:e.jsx(bs,{fontSize:"large"})}),e.jsxs(Hs,{children:[e.jsx(zs,{children:e.jsx(De,{to:`/post/${s}/${a}`,style:{textDecoration:"none"},children:e.jsx(F,{variant:"body2",textAlign:"center",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:x})})}),e.jsx(_s,{children:e.jsxs(F,{variant:"caption",textOverflow:"ellipsis",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[e.jsx(ys,{children:i}),i]})}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[v&&e.jsx(F,{variant:"caption",children:n(v).format("DD-MM-YYYY")}),a&&l&&e.jsx(Ge,{_id:a,likedBy:l,likes:o,nameCollection:s})]})]})]},a))})}const Es=({permissions:r,nameCollection:s,image:x,placeList:a,mainTitle:p,defaultCategory:i=null})=>{const o=S(_),l=S(Tt),[v,u]=w.useState(!1),{displayName:y="No name",uid:c="No ID"}=S(Ie)||{},j=S(wt(s)),I=ye("(min-width:1100px)"),d=ye("(min-width:600px)"),g=ke(),T=vt(),m=ce(),b=T.pathname.split("/")[3],[D,k]=w.useState({}),[M,L]=w.useState({}),[q,C]=w.useState([]),[R,W]=w.useState(n()),[xe,E]=w.useState(!1),[Z,J]=w.useState(!1),[Q,Je]=w.useState(1),[K,Qe]=w.useState(100),[Ke,he]=w.useState(1),[$,me]=w.useState(1),[fe]=w.useState(10),[X,Xe]=w.useState(1),[et,ee]=w.useState(!1),tt=w.useRef(null),st=()=>ee(!0),nt=()=>ee(!1),ge=()=>E(!0),je=()=>{if(j.length>0){const f=document.getElementById("firstPost");f&&window.requestAnimationFrame(()=>{f.scrollIntoView({behavior:"smooth",block:"start"})})}},rt=()=>{$<X&&(me($+1),je())},at=()=>{$>1&&(me($-1),je())},it=async f=>{if(!(f!=null&&f.date)||!(f!=null&&f.startTime)||!(f!=null&&f.endTime))return;const B=n(f.date).format("YYYY-MM-DDT00:00:00.000[Z]"),te=n(f.date).hour(n(f.startTime).hour()).minute(n(f.startTime).minute()).toISOString(),O=n(f.date).hour(n(f.endTime).hour()).minute(n(f.endTime).minute()).toISOString();if(n(te).isAfter(n(O))){kt("error",o==="ua"?"Час закінчення не може бути раніше початку!":"End time cannot be earlier than start time!");return}const be={date:B,startTime:te,endTime:O,place:f.place,topic:f.topic,notes:f.notes,adder:{displayName:y,uid:c}};if(D._id){m(Ct({id:D._id,language:o,nameCollection:s,updateValue:be})).finally(()=>{E(!1),k({})});return}else m(It({language:o,nameCollection:s,data:be})).finally(()=>E(!1))};return w.useEffect(()=>{const f=Te.CancelToken.source(),B=`/lessons/${s}/${b}`;return T.pathname!==B&&g(B),(async()=>{try{await m(Dt({nameCollection:s,locationMonth:b,cancelToken:f,setTotalPages:he,page:Q,limit:K}))}catch(O){console.error("Ошибка при загрузке расписания:",O)}})(),()=>f.cancel("Компонент размонтирован или маршрут изменен")},[m,K,T.pathname,b,s,g,Q]),w.useEffect(()=>{const f=Te.CancelToken.source();return(async()=>{m(Mt({nameCollection:s,tag:s,page:$,limit:fe,cancelToken:f,setTotalPages:Xe}))})(),()=>f.cancel("Компонент размонтирован или параметры постов изменены")},[m,s,$,fe]),e.jsxs(e.Fragment,{children:[e.jsx(Pt,{}),e.jsxs(h,{sx:{mb:5,width:"100%"},children:[e.jsx(Ft,{image:x,title:p}),e.jsxs(h,{display:"flex",width:"100%",gap:"40px",mt:"40px",flexWrap:I?"nowrap":"wrap",justifyContent:"center",children:[e.jsx(Ve,{nameCollection:s,locationMonth:b,handleAddALesson:ge,setIsDay:W,setEditItem:k,editItem:D,open:xe,isDay:R,currentDay:q,setCurrentDay:C,permissions:r,isDeleteModal:Z,setIsDeleteModal:J,setDeleteItem:L}),e.jsx(H,{elevation:d?1:0,sx:{padding:d?5:"30px 0 0 0",width:"100%",boxShadow:"0px 0px 3px -2px rgba(0,0,0,0.82)"},children:e.jsxs(h,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:"30px",children:[e.jsx(Ue,{nameCollection:s,page:Q,setPage:Je,limit:K,setLimit:Qe,totalPages:Ke,setTotalPages:he,permissions:r,isDeleteModal:Z,setIsDeleteModal:J,handleAddALesson:ge,setEditItem:k,setDeleteItem:L}),we[s]&&e.jsx(Ae,{title:o==="en"?"Open a group in Telegram":"Відкрити групу в Telegram",children:e.jsx(es,{href:we[s]??null,target:"_blank",rel:"noopener noreferrer",children:e.jsxs(ts,{component:"div",variant:"button",children:[o==="en"?"JOIN":"ПРИЕДНАТИСЯ",e.jsx(ss,{color:"info",fontSize:"large"})]})})})]})})]}),e.jsxs($s,{children:[e.jsx(Ys,{ref:tt,children:l?e.jsx(h,{display:"flex",gap:"10px",children:[...Array(5)].map((f,B)=>e.jsxs(H,{sx:{p:2,mb:2,width:"300px",flexShrink:"0"},children:[e.jsx(re,{variant:"rectangular",width:"100%",height:150}),e.jsx(re,{width:"60%"}),e.jsx(re,{width:"80%"})]},B))}):e.jsx(e.Fragment,{children:(j==null?void 0:j.length)>0&&e.jsxs(e.Fragment,{children:[X>1&&$>1&&e.jsx(Pe,{children:e.jsx(Y,{size:"large",onClick:at,disabled:$===1,children:e.jsx(fs,{fontSize:"large"})})}),e.jsx(Ze,{postsArr:j,nameCollection:s}),X!==$&&e.jsx(Pe,{children:e.jsx(Y,{size:"large",onClick:rt,children:e.jsx(gs,{fontSize:"large"})})})]})})}),r&&e.jsx(U,{variant:"contained",onClick:st,children:St.addPost[o]})]}),e.jsx(Se,{open:v,sx:{color:"#fff",zIndex:f=>f.zIndex.drawer+1},children:e.jsx(ue,{color:"inherit"})}),e.jsx(le,{open:et,onClose:nt,closeAfterTransition:!0,children:e.jsx(xs,{children:e.jsx(hs,{nameCollection:s,setOpen:ee,setLoading:u,defaultTag:s,defaultCategory:i})})}),e.jsx(He,{open:xe,setOpen:E,onSubmit:it,placeList:a,isDay:R,editItem:D,setEditItem:k}),e.jsx(ze,{dispatch:m,isDeleteModal:Z,setIsDeleteModal:J,nameCollection:s,deleteItem:M,setDeleteItem:L})]})]})};Es.propTypes={permissions:t.bool.isRequired,nameCollection:t.string.isRequired,image:t.string.isRequired,placeList:t.array.isRequired,mainTitle:t.string.isRequired,defaultCategory:t.string};export{Es as default};
