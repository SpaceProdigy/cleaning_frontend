import{r as y,_ as ct,a_ as dt,Q as V,j as e,s as P,B as m,u as v,b as H,M as le,I as Y,T as C,d as r,n as U,a$ as ut,a as t,b0 as G,ao as ce,k as J,p as De,ap as Me,N as ke,af as pt,P as _,aI as xt,aJ as mt,a9 as ht,C as ft,D as gt,aK as jt,aM as Ie,aq as bt,b1 as Le,w as Fe,a0 as Ce,v as Tt,a5 as yt,g as wt,h as vt,aR as ye,aN as Pt,l as we,x as St,o as Dt,b2 as Mt,b3 as kt,a4 as It,b4 as Lt,b5 as Ft}from"./index-C8OyC57M.js";import{I as Ct}from"./ImageTitle-B7IpINWN.js";import{g as Rt,s as Re,h as qt,i as At,j as Yt,k as $t,l as Wt,m as Bt,n as zt,o as Ht,L as qe,A as Ae,b as _t,C as Ot,P as Et,u as Vt,e as Nt,D as Ut,a as Gt,S as Jt,d as Qt,f as Kt}from"./Rulse.styled-DTqZ7DpL.js";import{d as de}from"./Close-Dzkmx_Zi.js";import{u as Zt,C as z}from"./index.esm-v6dJumaS.js";import{o as Xt,c as es,a as ne,b as re}from"./index.esm-Dk6KchLF.js";import{C as ue}from"./CircularProgress-DgGW_SMI.js";import{T as oe}from"./TextField-BpyGnnlu.js";import{F as Ye,I as ts,a as ss}from"./OutlinedInput-CBqLnr36.js";import{S as ns,M as $e,a as rs}from"./Select-ByavKus2.js";import{F as as}from"./FormHelperText-CoSOEkcg.js";import{a as is,d as We}from"./Edit-14I93_Up.js";import{d as Be}from"./Delete-Y5vmQ_tp.js";import{A as os}from"./index-adQGZg4d.js";import{R as ls,F as ae,a as ie,T as cs,b as ds,c as us,d as N,e as q,f as ps,t as ve}from"./telegram-DgbFTfmd.js";import{P as xs}from"./Pagination-yy2gWN0W.js";import{b as ms,c as hs,d as fs}from"./PostSkeleton-8UfdxrQT.js";import{b as gs,d as js,a as bs}from"./Favorite-CeztSHxP.js";import{I as Ts,d as ys}from"./ImageNotSupported-DJNuXoDB.js";import{U as ws}from"./UniversalReactMarkdown-DH9v1k9B.js";import"./errorMessages-By38fUa9.js";import"./Skeleton-CqVFT7ZT.js";import"./createStyled-B9DXt8-8.js";import"./Link-C9_Eqwxr.js";import"./Stack-IA11H-OP.js";import"./CloudUpload-CzZ9Rg3-.js";const ze=({adapter:a,value:s,timezone:p,props:o})=>{if(s===null)return null;const{minTime:x,maxTime:c,minutesStep:d,shouldDisableTime:l,disableIgnoringDatePartForTimeValidation:h=!1,disablePast:f,disableFuture:g}=o,u=a.utils.date(void 0,p),j=Rt(h,a.utils);switch(!0){case!a.utils.isValid(s):return"invalidDate";case!!(x&&j(x,s)):return"minTime";case!!(c&&j(s,c)):return"maxTime";case!!(g&&a.utils.isAfter(s,u)):return"disableFuture";case!!(f&&a.utils.isBefore(s,u)):return"disablePast";case!!(l&&l(s,"hours")):return"shouldDisableTime-hours";case!!(l&&l(s,"minutes")):return"shouldDisableTime-minutes";case!!(l&&l(s,"seconds")):return"shouldDisableTime-seconds";case!!(d&&a.utils.getMinutes(s)%d!==0):return"minutesStep";default:return null}};ze.valueManager=Re;const vs=a=>{const s=qt(a),{forwardedProps:p,internalProps:o}=At(s,"time");return Yt({forwardedProps:p,internalProps:o,valueManager:Re,fieldValueManager:$t,validator:ze,valueType:"time"})},Ps=["slots","slotProps","InputProps","inputProps"],Pe=y.forwardRef(function(s,p){const o=Wt({props:s,name:"MuiTimeField"}),{slots:x,slotProps:c,InputProps:d,inputProps:l}=o,h=ct(o,Ps),f=o,g=(x==null?void 0:x.textField)??(s.enableAccessibleFieldDOMStructure?Bt:oe),u=dt({elementType:g,externalSlotProps:c==null?void 0:c.textField,externalForwardedProps:h,ownerState:f,additionalProps:{ref:p}});u.inputProps=V({},l,u.inputProps),u.InputProps=V({},d,u.InputProps);const j=vs(u),L=zt(j),T=Ht(V({},L,{slots:x,slotProps:c}));return e.jsx(g,V({},T))}),Ss=P(m)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:a})=>a.palette.background.paper};
  box-shadow: ${({theme:a})=>a.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ds=P(m)`
  position: absolute;
  right: 5px;
  top: 5px;
`;He.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,deleteItem:t.object.isRequired,dispatch:t.func,nameCollection:t.string.isRequired,setDeleteItem:t.func.isRequired};function He({isDeleteModal:a,setIsDeleteModal:s,deleteItem:p,dispatch:o,nameCollection:x,setDeleteItem:c}){const d=v(H);return e.jsx(le,{open:a,onClose:()=>{s(!1)},children:e.jsxs(Ss,{children:[e.jsx(Ds,{children:e.jsx(Y,{onClick:()=>{s(!1)},children:e.jsx(de,{})})}),e.jsxs(m,{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",children:[p&&e.jsx(C,{variant:"subtitle2",textAlign:"center",sx:l=>({color:l.palette.warning.main}),children:`${r(p.date).format("DD.MM.YYYY")} ${d==="ua"?"Локація:":"Location:"} ${p.place}, ${d==="ua"?"Час: ":"Time: "}
            ${r(p.startTime).format("HH:mm")}:   ${r(p.endTime).format("HH:mm")}`}),e.jsx(C,{variant:"subtitle2",textAlign:"center",sx:l=>({color:l.palette.error.main}),children:d==="en"?"Warning: If you delete this lesson, it cannot be restored.":"Попередження: якщо ви видалите цей урок, його не можна буде відновити."}),e.jsxs(m,{display:"flex",gap:"20px",children:[e.jsx(U,{onClick:()=>s(!1),children:d==="en"?"Close":"Закрити"}),e.jsx(U,{onClick:()=>{o(ut({nameCollection:x,language:d,id:p._id})).finally(()=>c({})),s(!1)},children:d==="en"?"Delete":"Видалити"})]})]})]})})}const Ms=P(m)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:a})=>a.palette.background.paper};
  box-shadow: ${({theme:a})=>a.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,ks=P(m)`
  position: absolute;
  right: 5px;
  top: 5px;
`,Is=a=>es({date:re().required(a==="ua"?"Дата обов'язкова":"Date is required"),startTime:re().required(a==="ua"?"Час обов'язковий":"Time is required"),endTime:re().required(a==="ua"?"Час закінчення обов'язковий":"End time is required").test("is-after",a==="ua"?"Час закінчення повинен бути після початку":"End time must be after start time",function(s){const{startTime:p}=this.parent;return r(s).isAfter(r(p))}),place:ne().required(a==="ua"?"Оберіть місце":"Choose a location"),topic:ne().max(100,a==="ua"?"Максимум 100 символів":"Max 100 characters"),notes:ne().max(500,a==="ua"?"Максимум 500 символів":"Max 500 characters")});_e.propTypes={open:t.bool,setOpen:t.func,onSubmit:t.func,isDay:t.object,placeList:t.array.isRequired,editItem:t.object,setEditItem:t.func,nameCollection:t.string.isRequired};function _e({open:a,setOpen:s,onSubmit:p,placeList:o,isDay:x,editItem:c,setEditItem:d,nameCollection:l}){const h=v(H),f=v(G),g=v(ce),u=J(),{control:j,handleSubmit:L,formState:{errors:T},reset:k}=Zt({resolver:Xt(Is(h)),defaultValues:{date:x||r(),startTime:r().hour(17).minute(30),endTime:r().hour(19).minute(0),place:o[0].en,topic:"",notes:""},mode:"onChange"}),S=n=>{u(Me({["startTime"+l]:n.startTime.toISOString(),["endTime"+l]:n.endTime.toISOString(),["place"+l]:n.place})),p(n).finally(()=>k())};return y.useEffect(()=>{(()=>{let i={};c!=null&&c._id?i={date:r(c.date).startOf("day"),startTime:r(c.startTime),endTime:r(c.endTime),place:c.place,topic:c.topic,notes:c.notes}:x&&(i={date:x||r(),startTime:r().hour(17).minute(30),endTime:r().hour(19).minute(0),place:o[0].en,topic:"",notes:""}),g["startTime"+l]&&(i.startTime=r(g["startTime"+l])),g["endTime"+l]&&(i.endTime=r(g["endTime"+l])),g["place"+l]&&(i.place=g["place"+l]),k(i)})()},[c,x,g,l,o,k,d]),e.jsx(le,{open:a,onClose:()=>s(!1),children:e.jsxs(Ms,{children:[e.jsx(De,{open:f,sx:{color:"#fff",zIndex:n=>n.zIndex.modal+1,backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsx(ue,{color:"inherit"})}),e.jsx(ks,{children:e.jsx(Y,{onClick:()=>s(!1),children:e.jsx(de,{})})}),e.jsxs("form",{onSubmit:L(S),style:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:400},children:[e.jsxs(qe,{dateAdapter:Ae,children:[e.jsx(z,{name:"date",control:j,render:({field:n})=>{var i;return e.jsx(_t,{...n,label:h==="ua"?"Дата":"Date",format:"DD.MM.YYYY",value:n.value||null,onChange:w=>n.onChange(w||r()),slotProps:{textField:{fullWidth:!0,error:!!T.date,helperText:(i=T.date)==null?void 0:i.message,sx:{mb:2}}}})}}),e.jsx(z,{name:"startTime",control:j,render:({field:n})=>{var i;return e.jsx(Pe,{...n,label:h==="ua"?"Початок":"Start Time",format:"HH:mm",value:n.value||null,onChange:w=>n.onChange(w||r()),slotProps:{textField:{fullWidth:!0,error:!!T.time,helperText:(i=T.time)==null?void 0:i.message,sx:{mb:2}}}})}}),e.jsx(z,{name:"endTime",control:j,render:({field:n})=>{var i;return e.jsx(Pe,{...n,label:h==="ua"?"Час закінчення":"End Time",format:"HH:mm",value:n.value||null,onChange:w=>n.onChange(w||r()),slotProps:{textField:{fullWidth:!0,error:!!T.endTime,helperText:(i=T.endTime)==null?void 0:i.message,sx:{mb:2}}}})}})]}),e.jsx(z,{name:"place",control:j,render:({field:n})=>{var i;return e.jsxs(Ye,{sx:{width:"100%",maxWidth:400,mb:2},error:!!T.place,children:[e.jsx(ts,{children:h==="ua"?"Виберіть локацію":"Choose a location"}),e.jsx(ns,{...n,label:h==="ua"?"Виберіть локацію":"Choose a location",children:o.map((w,D)=>e.jsx($e,{value:w.en,children:w[h]},D))}),e.jsx(as,{children:(i=T.place)==null?void 0:i.message})]})}}),e.jsx(z,{name:"topic",control:j,render:({field:n})=>{var i;return e.jsx(oe,{...n,label:h==="ua"?"Тема заняття":"Lesson Topic",fullWidth:!0,sx:{mb:2},error:!!T.topic,helperText:((i=T.topic)==null?void 0:i.message)||(h==="ua"?"Максимум 100 символів":"Max 100 characters")})}}),e.jsx(z,{name:"notes",control:j,render:({field:n})=>{var i;return e.jsx(oe,{...n,label:h==="ua"?"Нотатки":"Notes",fullWidth:!0,multiline:!0,rows:3,sx:{mb:2},error:!!T.notes,helperText:((i=T.notes)==null?void 0:i.message)||(h==="ua"?"Максимум 500 символів":"Max 500 characters")})}}),e.jsx(U,{type:"submit",variant:"contained",fullWidth:!0,size:"large",children:h==="en"?"Submit":"Додати"})]})]})})}const Ls=P(m)`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 16px;
`,Fs=P(m)`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;

  padding: 5px 0px;
`;P(m)`
  width: 100%;
  display: flex;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
  color: ${({theme:a})=>a.palette.warning.main};
`;const Cs=P(m)`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
`,Rs=P(m)`
  display: flex;
  flex-direction: column;
  /* align-items: center; */
  gap: 5px;
  white-space: nowrap;
`,qs=P(m)`
  display: flex;
  align-items: center;
  gap: 12px;
  white-space: nowrap;
`;P(ke)`
  text-decoration: none;
  color: transparent;
`;const Oe=({currentDay:a,handleClose:s,language:p,handleAddALesson:o,isDay:x,setDeleteItem:c,permissions:d,setIsDeleteModal:l,setEditItem:h})=>{const[f]=y.useState(!1),g=v(G);return e.jsx(pt.div,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:100},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(_,{elevation:2,children:e.jsx(Ot,{onClickAway:()=>{f||s()},children:e.jsxs(m,{children:[e.jsxs(Ls,{children:[e.jsx(C,{variant:"subtitle2",children:r(x).format("YYYY-MM-DD")}),e.jsx(Y,{onClick:s,size:"small",children:e.jsx(de,{fontSize:"small"})})]}),d&&e.jsx(e.Fragment,{children:e.jsx(rs,{children:e.jsxs($e,{disabled:g,onClick:()=>{h({}),o()},children:[e.jsx(xt,{children:p==="en"?"Add Lesson":"Додайти урок"}),e.jsx(mt,{sx:{ml:2},children:e.jsx(is,{color:"success"})})]})})}),a==null?void 0:a.map(({place:u,startTime:j,endTime:L},T,k)=>e.jsxs(Fs,{children:[e.jsx(ht,{sx:{width:"100%"}}),e.jsxs(Cs,{children:[e.jsxs(Rs,{children:[e.jsx(C,{variant:"subtitle2",sx:S=>({color:S.palette.success.main}),children:`${u}`}),e.jsx(C,{variant:"subtitle2",sx:S=>({color:S.palette.success.main}),children:`${r(j).format("HH:mm")}:${r(L).format("HH:mm")}`})]}),d&&e.jsxs(qs,{children:[e.jsx(Y,{size:"small",onClick:()=>{h(k[T]),o()},children:e.jsx(We,{fontSize:"small",color:"secondary"})}),e.jsx(Y,{size:"small",onClick:()=>{c(k[T]),l(!0)},children:e.jsx(Be,{fontSize:"small",color:"error"})})]})]})]},T))]})})})})};Oe.propTypes={currentDay:t.array,handleAddALesson:t.func,isEdit:t.oneOfType([t.object,t.bool]),setIsEdit:t.func,open:t.bool,handleClose:t.func,language:t.string,isDay:t.oneOfType([t.object,t.oneOf([null])]),setDeleteItem:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,setEditItem:t.func};var pe={},As=ft;Object.defineProperty(pe,"__esModule",{value:!0});var Ee=pe.default=void 0,Ys=As(gt()),$s=e;Ee=pe.default=(0,Ys.default)((0,$s.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");const Ve=({permissions:a,setIsModal:s,setCurrentDay:p,shouldDisplay:o,props:x,language:c})=>{const d=jt(),l=y.useMemo(()=>o.sort((f,g)=>{const u=new Date(f.date),j=new Date(g.date);if(u-j!==0)return u-j;const L=new Date(f.startTime),T=new Date(g.startTime);return L-T}),[o]),h=()=>{!a&&!o||!a&&o.length===0||(s(!0),p(o))};return e.jsx(m,{children:e.jsxs(m,{position:"relative",children:[o.length===1&&e.jsx(m,{sx:{position:"absolute",top:-5,right:-5,zIndex:5},children:e.jsx(Ee,{fontSize:"small",sx:{color:d.palette.success.main}})}),e.jsx(m,{children:o.length>1&&e.jsx(m,{sx:f=>({position:"absolute",top:-2,right:-2,width:16,height:16,borderRadius:"50%",background:f.palette.secondary.main,display:"flex",justifyContent:"center",alignItems:"center",zIndex:5}),children:e.jsx(C,{variant:"caption",color:"#111",children:o.length})})}),e.jsx(Ie,{component:"div",classes:{tooltip:"custom-tooltip"},title:l.length>0&&e.jsx("div",{style:{maxHeight:100,overflow:"auto",scrollbarWidth:"thin",padding:5},children:l.map(({startTime:f,endTime:g,place:u})=>e.jsxs("div",{style:{padding:5},children:[e.jsxs(C,{variant:"subtitle2",textAlign:"center",component:"div",children:[c==="ua"?"Локація: ":"Location: ",u]}),e.jsxs(C,{variant:"subtitle2",textAlign:"center",component:"div",children:[c==="ua"?"Час: ":"Time: ",r(f).format("HH:mm"),":",r(g).format("HH:mm")]})]},bt()))}),placement:"top-end",children:e.jsx(Et,{onClick:h,...x,sx:{border:x.today?`solid 2px ${d.palette.info.main} !important`:o.length>0&&`solid 2px ${d.palette.success.main}`,background:x.today&&`${d.palette.info.main} !important`}})})]})})};Ve.propTypes={props:t.object,today:t.bool,setIsModal:t.func,setCurrentDay:t.func,shouldDisplay:t.array,permissions:t.bool.isRequired,isEdit:t.oneOfType([t.object,t.bool]),language:t.string};function Ne({handleAddALesson:a,setIsDay:s,editItem:p,setEditItem:o,open:x,isDay:c,permissions:d,isDeleteModal:l,setIsDeleteModal:h,locationMonth:f,nameCollection:g,currentDay:u,setCurrentDay:j,setDeleteItem:L}){const[T,k]=y.useState(!1),S=v(H),n=v(G),i=v(Le),w=Fe(),D=()=>{s(null),k(!1)},M=()=>!(r(f).isBefore(r().format("YYYY-MM"))||r(`${f}`).isAfter(r().format("YYYY-MM"))),F=y.useMemo(()=>({day:I})=>i==null?void 0:i.filter(({date:R})=>r(I).isSame(r(R),"day")),[i]),A=y.memo(Ve);return e.jsx(m,{children:e.jsxs(_,{elevation:1,sx:{p:2,position:"relative",boxShadow:"0px 0px 4px -2px rgba(0,0,0,0.52)","& .MuiPickersDay-root.Mui-selected":!M()&&{backgroundColor:"transparent !important",color:"inherit !important"}},children:[e.jsx(qe,{dateAdapter:Ae,localeText:S==="ua"?Vt.components.MuiLocalizationProvider.defaultProps.localeText:Nt.components.MuiLocalizationProvider.defaultProps.localeText,adapterLocale:S==="ua"?"uk":"en",children:e.jsx(Ut,{disabled:n,disableFuture:n,disablePast:n,value:null,onMonthChange:I=>{const R=`/lessons/${g}/${I.format("YYYY-MM")}`;location.pathname!==R&&w(R)},onChange:I=>s(I),views:["day"],loading:n,renderLoading:()=>e.jsx(Gt,{}),slots:{day:I=>{const R=F(I);return e.jsx(A,{permissions:d,setIsModal:k,shouldDisplay:R,props:I,language:S,setCurrentDay:j})}}},S)}),e.jsx(os,{children:T&&e.jsx(Oe,{setDeleteItem:L,currentDay:u,open:x,editItem:p,setEditItem:o,handleClose:D,language:S,handleAddALesson:a,isDay:c,permissions:d,isDeleteModal:l,setIsDeleteModal:h})})]})})}Ne.propTypes={currentDay:t.array.isRequired,setCurrentDay:t.func.isRequired,handleAddALesson:t.func,setIsDay:t.func,isDay:t.oneOfType([t.object,t.oneOf([null])]),editItem:t.object,setEditItem:t.func,open:t.bool,setValueSelect:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,nameCollection:t.string.isRequired,locationMonth:t.string.isRequired,setDeleteItem:t.func.isRequired};Ue.propTypes={isLoading:t.bool.isRequired,language:t.string.isRequired,nameCollection:t.string.isRequired};function Ue({isLoading:a,language:s,nameCollection:p}){const o=J(),x=v(ce);return e.jsx("div",{children:e.jsxs(Ye,{children:[e.jsx(ss,{children:s==="en"?"Show list":"Показувати список"}),e.jsxs(ls,{row:!0,value:x["filter"+p]?x["filter"+p]:"Fully",onChange:c=>o(Me({["filter"+p]:c.target.value})),children:[e.jsx(ae,{disabled:a,value:"Fully",control:e.jsx(ie,{}),label:s==="en"?"Fully":"Повністю"}),e.jsx(ae,{disabled:a,value:"Current week",control:e.jsx(ie,{}),label:s==="en"?"Current week":"Поточний тиждень"}),e.jsx(ae,{disabled:a,value:"Hide past dates",control:e.jsx(ie,{}),label:s==="en"?"Hide past dates":"Приховати минулі дати"})]})]})})}Ge.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,permissions:t.bool.isRequired,nameCollection:t.string.isRequired,page:t.number.isRequired,setPage:t.func.isRequired,limit:t.number.isRequired,setLimit:t.func.isRequired,totalPages:t.number.isRequired,setTotalPages:t.func.isRequired,setEditItem:t.func.isRequired,setDeleteItem:t.func.isRequired,handleAddALesson:t.func.isRequired};function Ge({setIsDeleteModal:a,permissions:s,setDeleteItem:p,nameCollection:o,handleAddALesson:x,setEditItem:c,page:d,setPage:l,totalPages:h}){const f=v(H),g=v(Le),u=v(G),j=v(ce),L=(n,i)=>{l(i)},T=(n,i,w,D)=>{const M={td:{maxWidth:"600px",borderBottom:w||D?"none":null}},F=r().format("YYYY-MM-DD"),A=r().isAfter(r(i),"day");return F===r(i).format("YYYY-MM-DD")?(M.td.color=n.palette.info.dark,M):(A&&(M.td.color=n.palette.grey.A400,M.backgroundColor=n.palette.grey[500]+20),M)},k=[...g].sort((n,i)=>{const w=new Date(n.date),D=new Date(i.date);if(w-D!==0)return w-D;const M=new Date(n.startTime),F=new Date(i.startTime);return M-F}),S=()=>{let n=k;return(j["filter"+o]?j["filter"+o]:"Fully")==="Hide past dates"&&(n=n==null?void 0:n.filter(({date:i})=>r(i).isAfter(r())||r(i).isSame(r(),"day"))),(j["filter"+o]?j["filter"+o]:"Fully")==="Current week"&&(n=n==null?void 0:n.filter(({date:i})=>{const w=r(i),D=r().startOf("week"),M=r().endOf("week");return w.isAfter(D)&&w.isBefore(M)})),n};return e.jsxs(e.Fragment,{children:[e.jsx(Ue,{isLoading:u,language:f,nameCollection:o}),e.jsxs(cs,{elevation:2,sx:{boxShadow:"0px 0px 5px -2px rgba(0,0,0,0.52)",width:"100%",maxWidth:"800px"},component:_,children:[e.jsxs(ds,{children:[e.jsx(us,{children:e.jsxs(N,{children:[e.jsx(q,{children:f==="ua"?"Дата":"Date"}),e.jsx(q,{children:f==="ua"?"Час":"Time"}),e.jsx(q,{sx:{whiteSpace:"nowrap"},children:f==="ua"?"Локація":"Location"}),s&&e.jsxs(e.Fragment,{children:[e.jsx(q,{align:"center",children:f==="en"?"Edit":"Редагувати"}),e.jsx(q,{align:"center",children:f==="en"?"Delete":"Видалити"})]})]})}),e.jsx(ps,{children:S().length>0&&S().map(({_id:n,date:i,startTime:w,endTime:D,place:M,topic:F="",notes:A=""},I,R)=>e.jsxs(y.Fragment,{children:[e.jsxs(N,{id:n,sx:W=>T(W,i,F,A),children:[e.jsx(q,{children:r(i).format("DD.MM.YYYY")}),e.jsxs(q,{children:[r(w).format("HH:mm"),":",r(D).format("HH:mm")]}),e.jsx(q,{children:M}),s&&e.jsxs(e.Fragment,{children:[e.jsx(q,{align:"center",children:e.jsx(Y,{disabled:u,color:"secondary",onClick:()=>{c(R[I]),x()},children:e.jsx(We,{})})}),e.jsx(q,{align:"center",children:e.jsx(Y,{disabled:u,color:"error",onClick:()=>{p(R[I]),a(!0)},children:e.jsx(Be,{})})})]})]}),F&&e.jsx(N,{sx:W=>({...T(W,i),textAlign:"start",background:"inherit"}),children:e.jsxs(q,{colSpan:5,sx:{overflowWrap:"break-word",borderBottom:A?"none":null},children:["Topic: ",F]})}),A&&e.jsx(N,{sx:W=>({...T(W,i),textAlign:"start",background:"inherit"}),children:e.jsxs(q,{colSpan:5,sx:{overflowWrap:"break-word"},children:["Notes: ",A]})})]},I))})]}),h>1&&e.jsx(m,{width:"100%",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(xs,{count:h,variant:"outlined",color:"primary",disabled:u,page:d,boundaryCount:0,onChange:L})}),u&&e.jsx(m,{width:"100%",height:"100px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(ue,{})}),!u&&k.length===0&&e.jsx(C,{variant:"h6",textAlign:"center",marginBottom:2,mt:2,children:f==="en"?"Lessons this month are not yet scheduled":"Уроки в цьому місяці ще не заплановано"})]})]})}const Ws=P(m)`
  margin-bottom: 20px;
  padding: 20px 0;
  width: 100%;
  display: flex;
  flex-wrap: nowrap;
  gap: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  scrollbar-width: thin;
`,Se=P(m)`
  display: flex;
  align-items: center;
  height: 100%;
`,Bs=P(m)`
  display: flex;
  flex-direction: column;

  align-items: center;
  margin-top: 20px;
`,zs=P(_)`
  flex: 0 0 auto;
  width: 100%;
  max-width: 300px;
  height: 400px;
  overflow: hidden;
  border-radius: 4px;
`,Hs=P(m)`
  width: 100%;
  height: 100%;
  max-width: 300px;
  max-height: 180px;
  display: flex;
  align-items: center;
  justify-content: center;
`,_s=P(m)`
  width: 100%;
  /* height: 100%; */
  max-width: 300px;
  max-height: 50px;
  display: flex;
  overflow: auto;
  scrollbar-width: thin;
`,Os=P(m)`
  padding: 10px;
  width: 100%;
  height: 100%;
  max-height: 220px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;

  overflow: hidden;
`,Es=P(m)`
  width: 100%;
  max-height: 120px;

  overflow: hidden;
`;Je.propTypes={_id:t.string.isRequired,likedBy:t.array.isRequired,likes:t.number.isRequired,setIsLiking:t.func,nameCollection:t.string.isRequired,isLiking:t.bool};function Je({_id:a,likedBy:s,likes:p,setIsLiking:o,nameCollection:x,isLiking:c}){const d=J(),l=v(Ce),h=v(Tt),f=u=>{o&&o(!0),d(yt({postId:u,userId:l.uid,displayName:l.displayName,avatar:l.photoURL,nameCollection:x})).finally(()=>{o&&o(!1)})},g=u=>u.length>0?u==null?void 0:u.findIndex(j=>j.userId===(l==null?void 0:l.uid)):-1;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",justifyContent:"flex-end"},children:[e.jsx(Y,{disabled:!h||c,onClick:()=>f(a),color:g(s)!==-1?"error":"default",children:e.jsx(gs,{sx:{transition:"transform 0.2s",transform:g(s)!==-1?"scale(1.2)":"scale(1)"}})}),e.jsx(C,{variant:"body1",children:p})]})}Qe.propTypes={postsArr:t.array.isRequired,nameCollection:t.string.isRequired,setIsLiking:t.func,isLiking:t.bool};function Qe({postsArr:a,nameCollection:s,setIsLiking:p,isLiking:o}){return e.jsx(e.Fragment,{children:a.map(({title:x,_id:c,posters:d,description:l,likes:h,likedBy:f,createdAt:g},u)=>e.jsxs(zs,{id:u===0?"firstPost":void 0,children:[(d==null?void 0:d.length)>0?e.jsx(Ts,{images:d,variant:"post"}):e.jsx(Hs,{children:e.jsx(ys,{fontSize:"large"})}),e.jsxs(Os,{children:[e.jsx(_s,{children:e.jsx(ke,{to:`/post/${s}/${c}`,style:{textDecoration:"none"},children:e.jsx(C,{variant:"body2",textAlign:"center",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:x})})}),e.jsx(Es,{children:e.jsxs(C,{variant:"caption",textOverflow:"ellipsis",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[e.jsx(ws,{children:l}),l]})}),e.jsxs(m,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[g&&e.jsx(C,{variant:"caption",children:r(g).format("DD-MM-YYYY")}),c&&f&&e.jsx(Je,{isLiking:o,setIsLiking:p,_id:c,likedBy:f,likes:h,nameCollection:s})]})]})]},c))})}const Vs=({permissions:a,nameCollection:s,image:p,placeList:o,mainTitle:x,defaultCategory:c=null})=>{const d=v(H),l=v(wt),[h,f]=y.useState(!1),{displayName:g="No name",uid:u="No ID"}=v(Ce)||{},j=v(vt(s)),L=ye("(min-width:1100px)"),T=ye("(min-width:600px)"),k=Fe(),S=Pt(),n=J(),i=S.pathname.split("/")[3],[w,D]=y.useState({}),[M,F]=y.useState({}),[A,I]=y.useState([]),[R,W]=y.useState(r()),[xe,O]=y.useState(!1),[Q,K]=y.useState(!1),[Z,Ke]=y.useState(1),[X,Ze]=y.useState(100),[Xe,me]=y.useState(1),[$,he]=y.useState(1),[fe]=y.useState(10),[ee,et]=y.useState(1),[tt,te]=y.useState(!1),[ge,st]=y.useState(!1),nt=y.useRef(null),rt=()=>te(!0),at=()=>te(!1),je=()=>O(!0),be=()=>{if(j.length>0){const b=document.getElementById("firstPost");b&&window.requestAnimationFrame(()=>{b.scrollIntoView({behavior:"smooth",block:"start"})})}},it=()=>{$<ee&&(he($+1),be())},ot=()=>{$>1&&(he($-1),be())},lt=async b=>{if(!(b!=null&&b.date)||!(b!=null&&b.startTime)||!(b!=null&&b.endTime))return;const B=r(b.date).format("YYYY-MM-DDT00:00:00.000[Z]"),se=r(b.date).hour(r(b.startTime).hour()).minute(r(b.startTime).minute()).toISOString(),E=r(b.date).hour(r(b.endTime).hour()).minute(r(b.endTime).minute()).toISOString();if(r(se).isAfter(r(E))){It("error",d==="ua"?"Час закінчення не може бути раніше початку!":"End time cannot be earlier than start time!");return}const Te={date:B,startTime:se,endTime:E,place:b.place,topic:b.topic,notes:b.notes,adder:{displayName:g,uid:u}};if(w._id){n(Lt({id:w._id,language:d,nameCollection:s,updateValue:Te})).finally(()=>{O(!1),D({})});return}else n(Ft({language:d,nameCollection:s,data:Te})).finally(()=>O(!1))};return y.useEffect(()=>{const b=we.CancelToken.source(),B=`/lessons/${s}/${i}`;return S.pathname!==B&&k(B),(async()=>{try{await n(Mt({nameCollection:s,locationMonth:i,cancelToken:b,setTotalPages:me,page:Z,limit:X}))}catch(E){console.error("Ошибка при загрузке расписания:",E)}})(),()=>b.cancel("Компонент размонтирован или маршрут изменен")},[n,X,S.pathname,i,s,k,Z]),y.useEffect(()=>{const b=we.CancelToken.source();return(async()=>{n(kt({nameCollection:s,tag:s,page:$,limit:fe,cancelToken:b,setTotalPages:et}))})(),()=>b.cancel("Компонент размонтирован или параметры постов изменены")},[n,s,$,fe]),e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsxs(m,{sx:{mb:5,width:"100%"},children:[e.jsx(Ct,{image:p,title:x}),e.jsxs(m,{display:"flex",width:"100%",gap:"40px",mt:"40px",flexWrap:L?"nowrap":"wrap",justifyContent:"center",children:[e.jsx(Ne,{nameCollection:s,locationMonth:i,handleAddALesson:je,setIsDay:W,setEditItem:D,editItem:w,open:xe,isDay:R,currentDay:A,setCurrentDay:I,permissions:a,isDeleteModal:Q,setIsDeleteModal:K,setDeleteItem:F}),e.jsx(_,{elevation:T?1:0,sx:{padding:T?5:"30px 0 0 0",width:"100%",boxShadow:"0px 0px 3px -2px rgba(0,0,0,0.82)"},children:e.jsxs(m,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:"30px",children:[e.jsx(Ge,{nameCollection:s,page:Z,setPage:Ke,limit:X,setLimit:Ze,totalPages:Xe,setTotalPages:me,permissions:a,isDeleteModal:Q,setIsDeleteModal:K,handleAddALesson:je,setEditItem:D,setDeleteItem:F}),ve[s]&&e.jsx(Ie,{title:d==="en"?"Open a group in Telegram":"Відкрити групу в Telegram",children:e.jsx(Jt,{href:ve[s]??null,target:"_blank",rel:"noopener noreferrer",children:e.jsxs(Qt,{component:"div",variant:"button",children:[d==="en"?"JOIN":"ПРИЕДНАТИСЯ",e.jsx(Kt,{color:"info",fontSize:"large"})]})})})]})})]}),e.jsxs(Bs,{children:[e.jsx(Ws,{ref:nt,children:l&&!ge?e.jsx(m,{display:"flex",gap:"10px",children:[...Array(5)].map((b,B)=>e.jsx(ms,{},B))}):e.jsx(e.Fragment,{children:(j==null?void 0:j.length)>0&&e.jsxs(e.Fragment,{children:[ee>1&&$>1&&e.jsx(Se,{children:e.jsx(Y,{size:"large",onClick:ot,disabled:$===1,children:e.jsx(js,{fontSize:"large"})})}),e.jsx(Qe,{postsArr:j,nameCollection:s,setIsLiking:st,isLiking:ge}),ee!==$&&e.jsx(Se,{children:e.jsx(Y,{size:"large",onClick:it,children:e.jsx(bs,{fontSize:"large"})})})]})})}),a&&e.jsx(U,{variant:"contained",onClick:rt,children:Dt.addPost[d]})]}),e.jsx(De,{open:h,sx:{color:"#fff",zIndex:b=>b.zIndex.drawer+1},children:e.jsx(ue,{color:"inherit"})}),e.jsx(le,{open:tt,onClose:at,closeAfterTransition:!0,children:e.jsx(hs,{children:e.jsx(fs,{nameCollection:s,setOpen:te,setLoading:f,defaultTag:s,defaultCategory:c})})}),e.jsx(_e,{open:xe,setOpen:O,onSubmit:lt,placeList:o,isDay:R,editItem:w,setEditItem:D,nameCollection:s}),e.jsx(He,{dispatch:n,isDeleteModal:Q,setIsDeleteModal:K,nameCollection:s,deleteItem:M,setDeleteItem:F})]})]})};Vs.propTypes={permissions:t.bool.isRequired,nameCollection:t.string.isRequired,image:t.string.isRequired,placeList:t.array.isRequired,mainTitle:t.string.isRequired,defaultCategory:t.string};export{Vs as default};
