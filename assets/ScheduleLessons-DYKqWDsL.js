import{r as w,_ as lt,aZ as ct,Q as V,j as e,s as S,B as h,u as v,b as _,M as ce,I as Y,T as L,d as r,n as U,a_ as dt,a as t,a$ as G,aJ as de,k as Q,p as De,aK as Me,N as ke,ae as ut,P as H,aD as pt,aE as xt,a9 as ht,C as mt,D as ft,aF as gt,aH as Ie,ar as jt,b0 as Ce,w as Fe,a0 as Le,v as bt,a5 as Tt,g as yt,h as wt,aW as ye,aQ as vt,l as we,x as St,o as Pt,b1 as Dt,b2 as Mt,a4 as kt,b3 as It,b4 as Ct}from"./index-Djjy5-H_.js";import{P as Ft,I as Lt}from"./ImageTitle-Cfs3DnSl.js";import{o as Rt,s as Re,p as qt,q as At,r as Yt,v as $t,w as Wt,x as Bt,y as zt,z as Ht,L as qe,A as Ae,i as _t,C as Ot,P as Et,u as Vt,e as Nt,D as Ut,a as Gt,R as Qt,F as ne,b as re,T as Jt,c as Zt,d as Kt,f as N,g as q,h as Xt,t as ve,l as es,m as ts,n as ss}from"./Rulse.styled-Zzkq0W6i.js";import{d as ue}from"./Close-qbN8cPS2.js";import{u as ns,C as z}from"./index.esm-BrsULErR.js";import{o as rs,c as as,a as ae,b as ie}from"./index.esm-jRXssaHQ.js";import{C as pe}from"./CircularProgress-C2aTVFHb.js";import{T as le,d as Ye}from"./Delete-COiInGie.js";import{F as $e,I as is,a as os,b as ls}from"./OutlinedInput-CVSd0nJT.js";import{S as cs,M as We,a as ds}from"./Select-Dm-pidd2.js";import{a as us,d as Be}from"./Edit-Dc1vkn3j.js";import{A as ps}from"./index-bMRqafVM.js";import{b as xs,c as hs}from"./PostFileUploader-BDzsb1-L.js";import{b as ms,d as fs,a as gs}from"./Favorite-w_XSXwrY.js";import{I as js,d as bs}from"./ImageNotSupported-CdBJ0NbK.js";import{U as Ts}from"./UniversalReactMarkdown-Ckvz0F1i.js";import{S as oe}from"./Skeleton-l-u1yFaR.js";import"./errorMessages-CwXPayE3.js";import"./createStyled-CHjpFg_A.js";import"./Link-BkOUUU_7.js";import"./CloudUpload--UpCL3dV.js";const ze=({adapter:a,value:s,timezone:p,props:o})=>{if(s===null)return null;const{minTime:u,maxTime:d,minutesStep:l,shouldDisableTime:c,disableIgnoringDatePartForTimeValidation:x=!1,disablePast:m,disableFuture:f}=o,j=a.utils.date(void 0,p),b=Rt(x,a.utils);switch(!0){case!a.utils.isValid(s):return"invalidDate";case!!(u&&b(u,s)):return"minTime";case!!(d&&b(s,d)):return"maxTime";case!!(f&&a.utils.isAfter(s,j)):return"disableFuture";case!!(m&&a.utils.isBefore(s,j)):return"disablePast";case!!(c&&c(s,"hours")):return"shouldDisableTime-hours";case!!(c&&c(s,"minutes")):return"shouldDisableTime-minutes";case!!(c&&c(s,"seconds")):return"shouldDisableTime-seconds";case!!(l&&a.utils.getMinutes(s)%l!==0):return"minutesStep";default:return null}};ze.valueManager=Re;const ys=a=>{const s=qt(a),{forwardedProps:p,internalProps:o}=At(s,"time");return Yt({forwardedProps:p,internalProps:o,valueManager:Re,fieldValueManager:$t,validator:ze,valueType:"time"})},ws=["slots","slotProps","InputProps","inputProps"],Se=w.forwardRef(function(s,p){const o=Wt({props:s,name:"MuiTimeField"}),{slots:u,slotProps:d,InputProps:l,inputProps:c}=o,x=lt(o,ws),m=o,f=(u==null?void 0:u.textField)??(s.enableAccessibleFieldDOMStructure?Bt:le),j=ct({elementType:f,externalSlotProps:d==null?void 0:d.textField,externalForwardedProps:x,ownerState:m,additionalProps:{ref:p}});j.inputProps=V({},c,j.inputProps),j.InputProps=V({},l,j.InputProps);const b=ys(j),C=zt(b),T=Ht(V({},C,{slots:u,slotProps:d}));return e.jsx(f,V({},T))}),vs=S(h)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:a})=>a.palette.background.paper};
  box-shadow: ${({theme:a})=>a.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ss=S(h)`
  position: absolute;
  right: 5px;
  top: 5px;
`;He.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,deleteItem:t.object.isRequired,dispatch:t.func,nameCollection:t.string.isRequired,setDeleteItem:t.func.isRequired};function He({isDeleteModal:a,setIsDeleteModal:s,deleteItem:p,dispatch:o,nameCollection:u,setDeleteItem:d}){const l=v(_);return e.jsx(ce,{open:a,onClose:()=>{s(!1)},children:e.jsxs(vs,{children:[e.jsx(Ss,{children:e.jsx(Y,{onClick:()=>{s(!1)},children:e.jsx(ue,{})})}),e.jsxs(h,{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",children:[p&&e.jsx(L,{variant:"subtitle2",textAlign:"center",sx:c=>({color:c.palette.warning.main}),children:`${r(p.date).format("DD.MM.YYYY")} ${l==="ua"?"Локація:":"Location:"} ${p.place}, ${l==="ua"?"Час: ":"Time: "}
            ${r(p.startTime).format("HH:mm")}:   ${r(p.endTime).format("HH:mm")}`}),e.jsx(L,{variant:"subtitle2",textAlign:"center",sx:c=>({color:c.palette.error.main}),children:l==="en"?"Warning: If you delete this lesson, it cannot be restored.":"Попередження: якщо ви видалите цей урок, його не можна буде відновити."}),e.jsxs(h,{display:"flex",gap:"20px",children:[e.jsx(U,{onClick:()=>s(!1),children:l==="en"?"Close":"Закрити"}),e.jsx(U,{onClick:()=>{o(dt({nameCollection:u,language:l,id:p._id})).finally(()=>d({})),s(!1)},children:l==="en"?"Delete":"Видалити"})]})]})]})})}const Ps=S(h)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  background-color: ${({theme:a})=>a.palette.background.paper};
  box-shadow: ${({theme:a})=>a.shadows[11]};
  padding: 50px;
  border-radius: 5px;
`,Ds=S(h)`
  position: absolute;
  right: 5px;
  top: 5px;
`,Ms=a=>as({date:ie().required(a==="ua"?"Дата обов'язкова":"Date is required"),startTime:ie().required(a==="ua"?"Час обов'язковий":"Time is required"),endTime:ie().required(a==="ua"?"Час закінчення обов'язковий":"End time is required").test("is-after",a==="ua"?"Час закінчення повинен бути після початку":"End time must be after start time",function(s){const{startTime:p}=this.parent;return r(s).isAfter(r(p))}),place:ae().required(a==="ua"?"Оберіть місце":"Choose a location"),topic:ae().max(100,a==="ua"?"Максимум 100 символів":"Max 100 characters"),notes:ae().max(500,a==="ua"?"Максимум 500 символів":"Max 500 characters")});_e.propTypes={open:t.bool,setOpen:t.func,onSubmit:t.func,isDay:t.object,placeList:t.array.isRequired,editItem:t.object,setEditItem:t.func,nameCollection:t.string.isRequired};function _e({open:a,setOpen:s,onSubmit:p,placeList:o,isDay:u,editItem:d,setEditItem:l,nameCollection:c}){const x=v(_),m=v(G),f=v(de),j=Q(),{control:b,handleSubmit:C,formState:{errors:T},reset:k}=ns({resolver:rs(Ms(x)),defaultValues:{date:u||r(),startTime:r().hour(17).minute(30),endTime:r().hour(19).minute(0),place:o[0].en,topic:"",notes:""},mode:"onChange"}),P=n=>{j(Me({["startTime"+c]:n.startTime.toISOString(),["endTime"+c]:n.endTime.toISOString(),["place"+c]:n.place})),p(n).finally(()=>k())};return w.useEffect(()=>{(()=>{let i={};d!=null&&d._id?i={date:r(d.date).startOf("day"),startTime:r(d.startTime),endTime:r(d.endTime),place:d.place,topic:d.topic,notes:d.notes}:u&&(i={date:u||r(),startTime:r().hour(17).minute(30),endTime:r().hour(19).minute(0),place:o[0].en,topic:"",notes:""}),f["startTime"+c]&&(i.startTime=r(f["startTime"+c])),f["endTime"+c]&&(i.endTime=r(f["endTime"+c])),f["place"+c]&&(i.place=f["place"+c]),k(i)})()},[d,u,f,c,o,k,l]),e.jsx(ce,{open:a,onClose:()=>s(!1),children:e.jsxs(Ps,{children:[e.jsx(De,{open:m,sx:{color:"#fff",zIndex:n=>n.zIndex.modal+1,backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsx(pe,{color:"inherit"})}),e.jsx(Ds,{children:e.jsx(Y,{onClick:()=>s(!1),children:e.jsx(ue,{})})}),e.jsxs("form",{onSubmit:C(P),style:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:400},children:[e.jsxs(qe,{dateAdapter:Ae,children:[e.jsx(z,{name:"date",control:b,render:({field:n})=>{var i;return e.jsx(_t,{...n,label:x==="ua"?"Дата":"Date",format:"DD.MM.YYYY",value:n.value||null,onChange:y=>n.onChange(y||r()),slotProps:{textField:{fullWidth:!0,error:!!T.date,helperText:(i=T.date)==null?void 0:i.message,sx:{mb:2}}}})}}),e.jsx(z,{name:"startTime",control:b,render:({field:n})=>{var i;return e.jsx(Se,{...n,label:x==="ua"?"Початок":"Start Time",format:"HH:mm",value:n.value||null,onChange:y=>n.onChange(y||r()),slotProps:{textField:{fullWidth:!0,error:!!T.time,helperText:(i=T.time)==null?void 0:i.message,sx:{mb:2}}}})}}),e.jsx(z,{name:"endTime",control:b,render:({field:n})=>{var i;return e.jsx(Se,{...n,label:x==="ua"?"Час закінчення":"End Time",format:"HH:mm",value:n.value||null,onChange:y=>n.onChange(y||r()),slotProps:{textField:{fullWidth:!0,error:!!T.endTime,helperText:(i=T.endTime)==null?void 0:i.message,sx:{mb:2}}}})}})]}),e.jsx(z,{name:"place",control:b,render:({field:n})=>{var i;return e.jsxs($e,{sx:{width:"100%",maxWidth:400,mb:2},error:!!T.place,children:[e.jsx(is,{children:x==="ua"?"Виберіть локацію":"Choose a location"}),e.jsx(cs,{...n,label:x==="ua"?"Виберіть локацію":"Choose a location",children:o.map((y,D)=>e.jsx(We,{value:y.en,children:y[x]},D))}),e.jsx(os,{children:(i=T.place)==null?void 0:i.message})]})}}),e.jsx(z,{name:"topic",control:b,render:({field:n})=>{var i;return e.jsx(le,{...n,label:x==="ua"?"Тема заняття":"Lesson Topic",fullWidth:!0,sx:{mb:2},error:!!T.topic,helperText:((i=T.topic)==null?void 0:i.message)||(x==="ua"?"Максимум 100 символів":"Max 100 characters")})}}),e.jsx(z,{name:"notes",control:b,render:({field:n})=>{var i;return e.jsx(le,{...n,label:x==="ua"?"Нотатки":"Notes",fullWidth:!0,multiline:!0,rows:3,sx:{mb:2},error:!!T.notes,helperText:((i=T.notes)==null?void 0:i.message)||(x==="ua"?"Максимум 500 символів":"Max 500 characters")})}}),e.jsx(U,{type:"submit",variant:"contained",fullWidth:!0,size:"large",children:x==="en"?"Submit":"Додати"})]})]})})}const ks=S(h)`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 16px;
`,Is=S(h)`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;

  padding: 5px 0px;
`;S(h)`
  width: 100%;
  display: flex;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
  color: ${({theme:a})=>a.palette.warning.main};
`;const Cs=S(h)`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  padding: 5px 16px;
  white-space: nowrap;
`,Fs=S(h)`
  display: flex;
  flex-direction: column;
  /* align-items: center; */
  gap: 5px;
  white-space: nowrap;
`,Ls=S(h)`
  display: flex;
  align-items: center;
  gap: 12px;
  white-space: nowrap;
`;S(ke)`
  text-decoration: none;
  color: transparent;
`;const Oe=({currentDay:a,handleClose:s,language:p,handleAddALesson:o,isDay:u,setDeleteItem:d,permissions:l,setIsDeleteModal:c,setEditItem:x})=>{const[m]=w.useState(!1),f=v(G);return e.jsx(ut.div,{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:100},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(H,{elevation:2,children:e.jsx(Ot,{onClickAway:()=>{m||s()},children:e.jsxs(h,{children:[e.jsxs(ks,{children:[e.jsx(L,{variant:"subtitle2",children:r(u).format("YYYY-MM-DD")}),e.jsx(Y,{onClick:s,size:"small",children:e.jsx(ue,{fontSize:"small"})})]}),l&&e.jsx(e.Fragment,{children:e.jsx(ds,{children:e.jsxs(We,{disabled:f,onClick:()=>{x({}),o()},children:[e.jsx(pt,{children:p==="en"?"Add Lesson":"Додайти урок"}),e.jsx(xt,{sx:{ml:2},children:e.jsx(us,{color:"success"})})]})})}),a==null?void 0:a.map(({place:j,startTime:b,endTime:C},T,k)=>e.jsxs(Is,{children:[e.jsx(ht,{sx:{width:"100%"}}),e.jsxs(Cs,{children:[e.jsxs(Fs,{children:[e.jsx(L,{variant:"subtitle2",sx:P=>({color:P.palette.success.main}),children:`${j}`}),e.jsx(L,{variant:"subtitle2",sx:P=>({color:P.palette.success.main}),children:`${r(b).format("HH:mm")}:${r(C).format("HH:mm")}`})]}),l&&e.jsxs(Ls,{children:[e.jsx(Y,{size:"small",onClick:()=>{x(k[T]),o()},children:e.jsx(Be,{fontSize:"small",color:"secondary"})}),e.jsx(Y,{size:"small",onClick:()=>{d(k[T]),c(!0)},children:e.jsx(Ye,{fontSize:"small",color:"error"})})]})]})]},T))]})})})})};Oe.propTypes={currentDay:t.array,handleAddALesson:t.func,isEdit:t.oneOfType([t.object,t.bool]),setIsEdit:t.func,open:t.bool,handleClose:t.func,language:t.string,isDay:t.oneOfType([t.object,t.oneOf([null])]),setDeleteItem:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,setEditItem:t.func};var xe={},Rs=mt;Object.defineProperty(xe,"__esModule",{value:!0});var Ee=xe.default=void 0,qs=Rs(ft()),As=e;Ee=xe.default=(0,qs.default)((0,As.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");const Ve=({permissions:a,setIsModal:s,setCurrentDay:p,shouldDisplay:o,props:u,language:d})=>{const l=gt(),c=w.useMemo(()=>o.sort((m,f)=>{const j=new Date(m.date),b=new Date(f.date);if(j-b!==0)return j-b;const C=new Date(m.startTime),T=new Date(f.startTime);return C-T}),[o]),x=()=>{!a&&!o||!a&&o.length===0||(s(!0),p(o))};return e.jsx(h,{children:e.jsxs(h,{position:"relative",children:[o.length===1&&e.jsx(h,{sx:{position:"absolute",top:-5,right:-5,zIndex:5},children:e.jsx(Ee,{fontSize:"small",sx:{color:l.palette.success.main}})}),e.jsx(h,{children:o.length>1&&e.jsx(h,{sx:m=>({position:"absolute",top:-2,right:-2,width:16,height:16,borderRadius:"50%",background:m.palette.secondary.main,display:"flex",justifyContent:"center",alignItems:"center",zIndex:5}),children:e.jsx(L,{variant:"caption",color:"#111",children:o.length})})}),e.jsx(Ie,{component:"div",classes:{tooltip:"custom-tooltip"},title:c.length>0&&e.jsx("div",{style:{maxHeight:100,overflow:"auto",scrollbarWidth:"thin",padding:5},children:c.map(({startTime:m,endTime:f,place:j})=>e.jsxs("div",{style:{padding:5},children:[e.jsxs(L,{variant:"subtitle2",textAlign:"center",component:"div",children:[d==="ua"?"Локація: ":"Location: ",j]}),e.jsxs(L,{variant:"subtitle2",textAlign:"center",component:"div",children:[d==="ua"?"Час: ":"Time: ",r(m).format("HH:mm"),":",r(f).format("HH:mm")]})]},jt()))}),placement:"top-end",children:e.jsx(Et,{onClick:x,...u,sx:{border:u.today?`solid 2px ${l.palette.info.main} !important`:o.length>0&&`solid 2px ${l.palette.success.main}`,background:u.today&&`${l.palette.info.main} !important`}})})]})})};Ve.propTypes={props:t.object,today:t.bool,setIsModal:t.func,setCurrentDay:t.func,shouldDisplay:t.array,permissions:t.bool.isRequired,isEdit:t.oneOfType([t.object,t.bool]),language:t.string};function Ne({handleAddALesson:a,setIsDay:s,editItem:p,setEditItem:o,open:u,isDay:d,permissions:l,isDeleteModal:c,setIsDeleteModal:x,locationMonth:m,nameCollection:f,currentDay:j,setCurrentDay:b,setDeleteItem:C}){const[T,k]=w.useState(!1),P=v(_),n=v(G),i=v(Ce),y=Fe(),D=()=>{s(null),k(!1)},M=()=>!(r(m).isBefore(r().format("YYYY-MM"))||r(`${m}`).isAfter(r().format("YYYY-MM"))),F=w.useMemo(()=>({day:I})=>i==null?void 0:i.filter(({date:R})=>r(I).isSame(r(R),"day")),[i]),A=w.memo(Ve);return e.jsx(h,{children:e.jsxs(H,{elevation:1,sx:{p:2,position:"relative",boxShadow:"0px 0px 4px -2px rgba(0,0,0,0.52)","& .MuiPickersDay-root.Mui-selected":!M()&&{backgroundColor:"transparent !important",color:"inherit !important"}},children:[e.jsx(qe,{dateAdapter:Ae,localeText:P==="ua"?Vt.components.MuiLocalizationProvider.defaultProps.localeText:Nt.components.MuiLocalizationProvider.defaultProps.localeText,adapterLocale:P==="ua"?"uk":"en",children:e.jsx(Ut,{disabled:n,disableFuture:n,disablePast:n,value:null,onMonthChange:I=>{const R=`/lessons/${f}/${I.format("YYYY-MM")}`;location.pathname!==R&&y(R)},onChange:I=>s(I),views:["day"],loading:n,renderLoading:()=>e.jsx(Gt,{}),slots:{day:I=>{const R=F(I);return e.jsx(A,{permissions:l,setIsModal:k,shouldDisplay:R,props:I,language:P,setCurrentDay:b})}}},P)}),e.jsx(ps,{children:T&&e.jsx(Oe,{setDeleteItem:C,currentDay:j,open:u,editItem:p,setEditItem:o,handleClose:D,language:P,handleAddALesson:a,isDay:d,permissions:l,isDeleteModal:c,setIsDeleteModal:x})})]})})}Ne.propTypes={currentDay:t.array.isRequired,setCurrentDay:t.func.isRequired,handleAddALesson:t.func,setIsDay:t.func,isDay:t.oneOfType([t.object,t.oneOf([null])]),editItem:t.object,setEditItem:t.func,open:t.bool,setValueSelect:t.func,permissions:t.bool,isDeleteModal:t.bool,setIsDeleteModal:t.func,nameCollection:t.string.isRequired,locationMonth:t.string.isRequired,setDeleteItem:t.func.isRequired};Ue.propTypes={isLoading:t.bool.isRequired,language:t.string.isRequired,nameCollection:t.string.isRequired};function Ue({isLoading:a,language:s,nameCollection:p}){const o=Q(),u=v(de);return e.jsx("div",{children:e.jsxs($e,{children:[e.jsx(ls,{children:s==="en"?"Show list":"Показувати список"}),e.jsxs(Qt,{row:!0,value:u["filter"+p]?u["filter"+p]:"Fully",onChange:d=>o(Me({["filter"+p]:d.target.value})),children:[e.jsx(ne,{disabled:a,value:"Fully",control:e.jsx(re,{}),label:s==="en"?"Fully":"Повністю"}),e.jsx(ne,{disabled:a,value:"Current week",control:e.jsx(re,{}),label:s==="en"?"Current week":"Поточний тиждень"}),e.jsx(ne,{disabled:a,value:"Hide past dates",control:e.jsx(re,{}),label:s==="en"?"Hide past dates":"Приховати минулі дати"})]})]})})}Ge.propTypes={isDeleteModal:t.bool,setIsDeleteModal:t.func,permissions:t.bool.isRequired,nameCollection:t.string.isRequired,page:t.number.isRequired,setPage:t.func.isRequired,limit:t.number.isRequired,setLimit:t.func.isRequired,totalPages:t.number.isRequired,setTotalPages:t.func.isRequired,setEditItem:t.func.isRequired,setDeleteItem:t.func.isRequired,handleAddALesson:t.func.isRequired};function Ge({setIsDeleteModal:a,permissions:s,setDeleteItem:p,nameCollection:o,handleAddALesson:u,setEditItem:d,page:l,setPage:c,totalPages:x}){const m=v(_),f=v(Ce),j=v(G),b=v(de),C=(n,i)=>{c(i)},T=(n,i,y,D)=>{const M={td:{maxWidth:"600px",borderBottom:y||D?"none":null}},F=r().format("YYYY-MM-DD"),A=r().isAfter(r(i),"day");return F===r(i).format("YYYY-MM-DD")?(M.td.color=n.palette.info.dark,M):(A&&(M.td.color=n.palette.grey.A400,M.backgroundColor=n.palette.grey[500]+20),M)},k=[...f].sort((n,i)=>{const y=new Date(n.date),D=new Date(i.date);if(y-D!==0)return y-D;const M=new Date(n.startTime),F=new Date(i.startTime);return M-F}),P=()=>{let n=k;return(b["filter"+o]?b["filter"+o]:"Fully")==="Hide past dates"&&(n=n==null?void 0:n.filter(({date:i})=>r(i).isAfter(r())||r(i).isSame(r(),"day"))),(b["filter"+o]?b["filter"+o]:"Fully")==="Current week"&&(n=n==null?void 0:n.filter(({date:i})=>{const y=r(i),D=r().startOf("week"),M=r().endOf("week");return y.isAfter(D)&&y.isBefore(M)})),n};return e.jsxs(e.Fragment,{children:[e.jsx(Ue,{isLoading:j,language:m,nameCollection:o}),e.jsxs(Jt,{elevation:2,sx:{boxShadow:"0px 0px 5px -2px rgba(0,0,0,0.52)",width:"100%",maxWidth:"800px"},component:H,children:[e.jsxs(Zt,{children:[e.jsx(Kt,{children:e.jsxs(N,{children:[e.jsx(q,{children:m==="ua"?"Дата":"Date"}),e.jsx(q,{children:m==="ua"?"Час":"Time"}),e.jsx(q,{sx:{whiteSpace:"nowrap"},children:m==="ua"?"Локація":"Location"}),s&&e.jsxs(e.Fragment,{children:[e.jsx(q,{align:"center",children:m==="en"?"Edit":"Редагувати"}),e.jsx(q,{align:"center",children:m==="en"?"Delete":"Видалити"})]})]})}),e.jsx(Xt,{children:P().length>0&&P().map(({_id:n,date:i,startTime:y,endTime:D,place:M,topic:F="",notes:A=""},I,R)=>e.jsxs(w.Fragment,{children:[e.jsxs(N,{id:n,sx:W=>T(W,i,F,A),children:[e.jsx(q,{children:r(i).format("DD.MM.YYYY")}),e.jsxs(q,{children:[r(y).format("HH:mm"),":",r(D).format("HH:mm")]}),e.jsx(q,{children:M}),s&&e.jsxs(e.Fragment,{children:[e.jsx(q,{align:"center",children:e.jsx(Y,{disabled:j,color:"secondary",onClick:()=>{d(R[I]),u()},children:e.jsx(Be,{})})}),e.jsx(q,{align:"center",children:e.jsx(Y,{disabled:j,color:"error",onClick:()=>{p(R[I]),a(!0)},children:e.jsx(Ye,{})})})]})]}),F&&e.jsx(N,{sx:W=>({...T(W,i),textAlign:"start",background:"inherit"}),children:e.jsxs(q,{colSpan:5,sx:{overflowWrap:"break-word",borderBottom:A?"none":null},children:["Topic: ",F]})}),A&&e.jsx(N,{sx:W=>({...T(W,i),textAlign:"start",background:"inherit"}),children:e.jsxs(q,{colSpan:5,sx:{overflowWrap:"break-word"},children:["Notes: ",A]})})]},I))})]}),x>1&&e.jsx(h,{width:"100%",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(Ft,{count:x,variant:"outlined",color:"primary",disabled:j,page:l,boundaryCount:0,onChange:C})}),j&&e.jsx(h,{width:"100%",height:"100px",display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(pe,{})}),!j&&k.length===0&&e.jsx(L,{variant:"h6",textAlign:"center",marginBottom:2,mt:2,children:m==="en"?"Cleaning this month are not yet scheduled":"Прибирання в цьому місяці ще не заплановано"})]})]})}const Ys=S(h)`
  margin-bottom: 20px;
  padding: 20px 0;
  width: 100%;
  display: flex;
  flex-wrap: nowrap;
  gap: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  scrollbar-width: thin;
`,Pe=S(h)`
  display: flex;
  align-items: center;
  height: 100%;
`,$s=S(h)`
  display: flex;
  flex-direction: column;

  align-items: center;
  margin-top: 20px;
`,Ws=S(H)`
  flex: 0 0 auto;
  width: 100%;
  max-width: 300px;
  height: 400px;
  overflow: hidden;
  border-radius: 4px;
`,Bs=S(h)`
  width: 100%;
  height: 100%;
  max-width: 300px;
  max-height: 180px;
  display: flex;
  align-items: center;
  justify-content: center;
`,zs=S(h)`
  width: 100%;
  /* height: 100%; */
  max-width: 300px;
  max-height: 50px;
  display: flex;
  overflow: auto;
  scrollbar-width: thin;
`,Hs=S(h)`
  padding: 10px;
  width: 100%;
  height: 100%;
  max-height: 220px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;

  overflow: hidden;
`,_s=S(h)`
  width: 100%;
  max-height: 120px;

  overflow: hidden;
`;Qe.propTypes={_id:t.string.isRequired,likedBy:t.array.isRequired,likes:t.number.isRequired,setIsLiking:t.func,nameCollection:t.string.isRequired};function Qe({_id:a,likedBy:s,likes:p,setIsLiking:o,nameCollection:u}){const d=Q(),l=v(Le),c=v(bt),x=f=>{o&&o(!0),d(Tt({postId:f,userId:l.uid,displayName:l.displayName,avatar:l.photoURL,nameCollection:u})).finally(()=>{o&&o(!1)})},m=f=>f.length>0?f==null?void 0:f.findIndex(j=>j.userId===(l==null?void 0:l.uid)):-1;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",justifyContent:"flex-end"},children:[e.jsx(Y,{disabled:!c,onClick:()=>x(a),color:m(s)!==-1?"error":"default",children:e.jsx(ms,{sx:{transition:"transform 0.2s",transform:m(s)!==-1?"scale(1.2)":"scale(1)"}})}),e.jsx(L,{variant:"body1",children:p})]})}Je.propTypes={postsArr:t.array.isRequired,nameCollection:t.string.isRequired};function Je({postsArr:a,nameCollection:s}){return e.jsx(e.Fragment,{children:a.map(({title:p,_id:o,posters:u,description:d,likes:l,likedBy:c,createdAt:x},m)=>e.jsxs(Ws,{id:m===0?"firstPost":void 0,children:[(u==null?void 0:u.length)>0?e.jsx(js,{images:u,variant:"post"}):e.jsx(Bs,{children:e.jsx(bs,{fontSize:"large"})}),e.jsxs(Hs,{children:[e.jsx(zs,{children:e.jsx(ke,{to:`/post/${s}/${o}`,style:{textDecoration:"none"},children:e.jsx(L,{variant:"body2",textAlign:"center",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:p})})}),e.jsx(_s,{children:e.jsxs(L,{variant:"caption",textOverflow:"ellipsis",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[e.jsx(Ts,{children:d}),d]})}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[x&&e.jsx(L,{variant:"caption",children:r(x).format("DD-MM-YYYY")}),o&&c&&e.jsx(Qe,{_id:o,likedBy:c,likes:l,nameCollection:s})]})]})]},o))})}const Os=({permissions:a,nameCollection:s,image:p,placeList:o,mainTitle:u,defaultCategory:d=null})=>{const l=v(_),c=v(yt),[x,m]=w.useState(!1),{displayName:f="No name",uid:j="No ID"}=v(Le)||{},b=v(wt(s)),C=ye("(min-width:1100px)"),T=ye("(min-width:600px)"),k=Fe(),P=vt(),n=Q(),i=P.pathname.split("/")[3],[y,D]=w.useState({}),[M,F]=w.useState({}),[A,I]=w.useState([]),[R,W]=w.useState(r()),[he,O]=w.useState(!1),[J,Z]=w.useState(!1),[K,Ze]=w.useState(1),[X,Ke]=w.useState(100),[Xe,me]=w.useState(1),[$,fe]=w.useState(1),[ge]=w.useState(10),[ee,et]=w.useState(1),[tt,te]=w.useState(!1),st=w.useRef(null),nt=()=>te(!0),rt=()=>te(!1),je=()=>O(!0),be=()=>{if(b.length>0){const g=document.getElementById("firstPost");g&&window.requestAnimationFrame(()=>{g.scrollIntoView({behavior:"smooth",block:"start"})})}},at=()=>{$<ee&&(fe($+1),be())},it=()=>{$>1&&(fe($-1),be())},ot=async g=>{if(!(g!=null&&g.date)||!(g!=null&&g.startTime)||!(g!=null&&g.endTime))return;const B=r(g.date).format("YYYY-MM-DDT00:00:00.000[Z]"),se=r(g.date).hour(r(g.startTime).hour()).minute(r(g.startTime).minute()).toISOString(),E=r(g.date).hour(r(g.endTime).hour()).minute(r(g.endTime).minute()).toISOString();if(r(se).isAfter(r(E))){kt("error",l==="ua"?"Час закінчення не може бути раніше початку!":"End time cannot be earlier than start time!");return}const Te={date:B,startTime:se,endTime:E,place:g.place,topic:g.topic,notes:g.notes,adder:{displayName:f,uid:j}};if(y._id){n(It({id:y._id,language:l,nameCollection:s,updateValue:Te})).finally(()=>{O(!1),D({})});return}else n(Ct({language:l,nameCollection:s,data:Te})).finally(()=>O(!1))};return w.useEffect(()=>{const g=we.CancelToken.source(),B=`/lessons/${s}/${i}`;return P.pathname!==B&&k(B),(async()=>{try{await n(Dt({nameCollection:s,locationMonth:i,cancelToken:g,setTotalPages:me,page:K,limit:X}))}catch(E){console.error("Ошибка при загрузке расписания:",E)}})(),()=>g.cancel("Компонент размонтирован или маршрут изменен")},[n,X,P.pathname,i,s,k,K]),w.useEffect(()=>{const g=we.CancelToken.source();return(async()=>{n(Mt({nameCollection:s,tag:s,page:$,limit:ge,cancelToken:g,setTotalPages:et}))})(),()=>g.cancel("Компонент размонтирован или параметры постов изменены")},[n,s,$,ge]),e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsxs(h,{sx:{mb:5,width:"100%"},children:[e.jsx(Lt,{image:p,title:u}),e.jsxs(h,{display:"flex",width:"100%",gap:"40px",mt:"40px",flexWrap:C?"nowrap":"wrap",justifyContent:"center",children:[e.jsx(Ne,{nameCollection:s,locationMonth:i,handleAddALesson:je,setIsDay:W,setEditItem:D,editItem:y,open:he,isDay:R,currentDay:A,setCurrentDay:I,permissions:a,isDeleteModal:J,setIsDeleteModal:Z,setDeleteItem:F}),e.jsx(H,{elevation:T?1:0,sx:{padding:T?5:"30px 0 0 0",width:"100%",boxShadow:"0px 0px 3px -2px rgba(0,0,0,0.82)"},children:e.jsxs(h,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:"30px",children:[e.jsx(Ge,{nameCollection:s,page:K,setPage:Ze,limit:X,setLimit:Ke,totalPages:Xe,setTotalPages:me,permissions:a,isDeleteModal:J,setIsDeleteModal:Z,handleAddALesson:je,setEditItem:D,setDeleteItem:F}),ve[s]&&e.jsx(Ie,{title:l==="en"?"Open a group in Telegram":"Відкрити групу в Telegram",children:e.jsx(es,{href:ve[s]??null,target:"_blank",rel:"noopener noreferrer",children:e.jsxs(ts,{component:"div",variant:"button",children:[l==="en"?"JOIN":"ПРИЕДНАТИСЯ",e.jsx(ss,{color:"info",fontSize:"large"})]})})})]})})]}),e.jsxs($s,{children:[e.jsx(Ys,{ref:st,children:c?e.jsx(h,{display:"flex",gap:"10px",children:[...Array(5)].map((g,B)=>e.jsxs(H,{sx:{p:2,mb:2,width:"300px",flexShrink:"0"},children:[e.jsx(oe,{variant:"rectangular",width:"100%",height:150}),e.jsx(oe,{width:"60%"}),e.jsx(oe,{width:"80%"})]},B))}):e.jsx(e.Fragment,{children:(b==null?void 0:b.length)>0&&e.jsxs(e.Fragment,{children:[ee>1&&$>1&&e.jsx(Pe,{children:e.jsx(Y,{size:"large",onClick:it,disabled:$===1,children:e.jsx(fs,{fontSize:"large"})})}),e.jsx(Je,{postsArr:b,nameCollection:s}),ee!==$&&e.jsx(Pe,{children:e.jsx(Y,{size:"large",onClick:at,children:e.jsx(gs,{fontSize:"large"})})})]})})}),a&&e.jsx(U,{variant:"contained",onClick:nt,children:Pt.addPost[l]})]}),e.jsx(De,{open:x,sx:{color:"#fff",zIndex:g=>g.zIndex.drawer+1},children:e.jsx(pe,{color:"inherit"})}),e.jsx(ce,{open:tt,onClose:rt,closeAfterTransition:!0,children:e.jsx(xs,{children:e.jsx(hs,{nameCollection:s,setOpen:te,setLoading:m,defaultTag:s,defaultCategory:d})})}),e.jsx(_e,{open:he,setOpen:O,onSubmit:ot,placeList:o,isDay:R,editItem:y,setEditItem:D,nameCollection:s}),e.jsx(He,{dispatch:n,isDeleteModal:J,setIsDeleteModal:Z,nameCollection:s,deleteItem:M,setDeleteItem:F})]})]})};Os.propTypes={permissions:t.bool.isRequired,nameCollection:t.string.isRequired,image:t.string.isRequired,placeList:t.array.isRequired,mainTitle:t.string.isRequired,defaultCategory:t.string};export{Os as default};
